!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.gerberToSvg=t()}}(function(){return function t(e,r,n){function i(s,a){if(!r[s]){if(!e[s]){var u="function"==typeof require&&require;if(!a&&u)return u(s,!0);if(o)return o(s,!0);var h=new Error("Cannot find module '"+s+"'");throw h.code="MODULE_NOT_FOUND",h}var l=r[s]={exports:{}};e[s][0].call(l.exports,function(t){var r=e[s][1][t];return i(r?r:t)},l,l.exports,t,e,r,n)}return r[s].exports}for(var o="function"==typeof require&&require,s=0;s<n.length;s++)i(n[s]);return i}({1:[function(t,e,r){},{}],2:[function(t,e,r){function n(t){return this instanceof n?(this.length=0,this.parent=void 0,"number"==typeof t?i(this,t):"string"==typeof t?o(this,t,arguments.length>1?arguments[1]:"utf8"):s(this,t)):arguments.length>1?new n(t,arguments[1]):new n(t)}function i(t,e){if(t=f(t,0>e?0:0|p(e)),!n.TYPED_ARRAY_SUPPORT)for(var r=0;e>r;r++)t[r]=0;return t}function o(t,e,r){("string"!=typeof r||""===r)&&(r="utf8");var n=0|g(e,r);return t=f(t,n),t.write(e,r),t}function s(t,e){if(n.isBuffer(e))return a(t,e);if(G(e))return u(t,e);if(null==e)throw new TypeError("must start with number, buffer, array or string");return"undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer?h(t,e):e.length?l(t,e):c(t,e)}function a(t,e){var r=0|p(e.length);return t=f(t,r),e.copy(t,0,0,r),t}function u(t,e){var r=0|p(e.length);t=f(t,r);for(var n=0;r>n;n+=1)t[n]=255&e[n];return t}function h(t,e){var r=0|p(e.length);t=f(t,r);for(var n=0;r>n;n+=1)t[n]=255&e[n];return t}function l(t,e){var r=0|p(e.length);t=f(t,r);for(var n=0;r>n;n+=1)t[n]=255&e[n];return t}function c(t,e){var r,n=0;"Buffer"===e.type&&G(e.data)&&(r=e.data,n=0|p(r.length)),t=f(t,n);for(var i=0;n>i;i+=1)t[i]=255&r[i];return t}function f(t,e){n.TYPED_ARRAY_SUPPORT?t=n._augment(new Uint8Array(e)):(t.length=e,t._isBuffer=!0);var r=0!==e&&e<=n.poolSize>>>1;return r&&(t.parent=Z),t}function p(t){if(t>=X)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+X.toString(16)+" bytes");return 0|t}function d(t,e){if(!(this instanceof d))return new d(t,e);var r=new n(t,e);return delete r.parent,r}function g(t,e){if("string"!=typeof t&&(t=String(t)),0===t.length)return 0;switch(e||"utf8"){case"ascii":case"binary":case"raw":return t.length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*t.length;case"hex":return t.length>>>1;case"utf8":case"utf-8":return N(t).length;case"base64":return F(t).length;default:return t.length}}function b(t,e,r,n){r=Number(r)||0;var i=t.length-r;n?(n=Number(n),n>i&&(n=i)):n=i;var o=e.length;if(o%2!==0)throw new Error("Invalid hex string");n>o/2&&(n=o/2);for(var s=0;n>s;s++){var a=parseInt(e.substr(2*s,2),16);if(isNaN(a))throw new Error("Invalid hex string");t[r+s]=a}return s}function y(t,e,r,n){return Y(N(e,t.length-r),t,r,n)}function m(t,e,r,n){return Y(C(e),t,r,n)}function w(t,e,r,n){return m(t,e,r,n)}function v(t,e,r,n){return Y(F(e),t,r,n)}function x(t,e,r,n){return Y(q(e,t.length-r),t,r,n)}function _(t,e,r){return 0===e&&r===t.length?W.fromByteArray(t):W.fromByteArray(t.slice(e,r))}function E(t,e,r){var n="",i="";r=Math.min(t.length,r);for(var o=e;r>o;o++)t[o]<=127?(n+=z(i)+String.fromCharCode(t[o]),i=""):i+="%"+t[o].toString(16);return n+z(i)}function M(t,e,r){var n="";r=Math.min(t.length,r);for(var i=e;r>i;i++)n+=String.fromCharCode(127&t[i]);return n}function k(t,e,r){var n="";r=Math.min(t.length,r);for(var i=e;r>i;i++)n+=String.fromCharCode(t[i]);return n}function j(t,e,r){var n=t.length;(!e||0>e)&&(e=0),(!r||0>r||r>n)&&(r=n);for(var i="",o=e;r>o;o++)i+=D(t[o]);return i}function R(t,e,r){for(var n=t.slice(e,r),i="",o=0;o<n.length;o+=2)i+=String.fromCharCode(n[o]+256*n[o+1]);return i}function A(t,e,r){if(t%1!==0||0>t)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}function L(t,e,r,i,o,s){if(!n.isBuffer(t))throw new TypeError("buffer must be a Buffer instance");if(e>o||s>e)throw new RangeError("value is out of bounds");if(r+i>t.length)throw new RangeError("index out of range")}function S(t,e,r,n){0>e&&(e=65535+e+1);for(var i=0,o=Math.min(t.length-r,2);o>i;i++)t[r+i]=(e&255<<8*(n?i:1-i))>>>8*(n?i:1-i)}function T(t,e,r,n){0>e&&(e=4294967295+e+1);for(var i=0,o=Math.min(t.length-r,4);o>i;i++)t[r+i]=e>>>8*(n?i:3-i)&255}function B(t,e,r,n,i,o){if(e>i||o>e)throw new RangeError("value is out of bounds");if(r+n>t.length)throw new RangeError("index out of range");if(0>r)throw new RangeError("index out of range")}function I(t,e,r,n,i){return i||B(t,e,r,4,3.4028234663852886e38,-3.4028234663852886e38),$.write(t,e,r,n,23,4),r+4}function O(t,e,r,n,i){return i||B(t,e,r,8,1.7976931348623157e308,-1.7976931348623157e308),$.write(t,e,r,n,52,8),r+8}function U(t){if(t=P(t).replace(H,""),t.length<2)return"";for(;t.length%4!==0;)t+="=";return t}function P(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function D(t){return 16>t?"0"+t.toString(16):t.toString(16)}function N(t,e){e=e||1/0;for(var r,n=t.length,i=null,o=[],s=0;n>s;s++){if(r=t.charCodeAt(s),r>55295&&57344>r){if(!i){if(r>56319){(e-=3)>-1&&o.push(239,191,189);continue}if(s+1===n){(e-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(56320>r){(e-=3)>-1&&o.push(239,191,189),i=r;continue}r=i-55296<<10|r-56320|65536,i=null}else i&&((e-=3)>-1&&o.push(239,191,189),i=null);if(128>r){if((e-=1)<0)break;o.push(r)}else if(2048>r){if((e-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(65536>r){if((e-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(2097152>r))throw new Error("Invalid code point");if((e-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function C(t){for(var e=[],r=0;r<t.length;r++)e.push(255&t.charCodeAt(r));return e}function q(t,e){for(var r,n,i,o=[],s=0;s<t.length&&!((e-=2)<0);s++)r=t.charCodeAt(s),n=r>>8,i=r%256,o.push(i),o.push(n);return o}function F(t){return W.toByteArray(U(t))}function Y(t,e,r,n){for(var i=0;n>i&&!(i+r>=e.length||i>=t.length);i++)e[i+r]=t[i];return i}function z(t){try{return decodeURIComponent(t)}catch(e){return String.fromCharCode(65533)}}var W=t("base64-js"),$=t("ieee754"),G=t("is-array");r.Buffer=n,r.SlowBuffer=d,r.INSPECT_MAX_BYTES=50,n.poolSize=8192;var X=1073741823,Z={};n.TYPED_ARRAY_SUPPORT=function(){try{var t=new ArrayBuffer(0),e=new Uint8Array(t);return e.foo=function(){return 42},42===e.foo()&&"function"==typeof e.subarray&&0===new Uint8Array(1).subarray(1,1).byteLength}catch(r){return!1}}(),n.isBuffer=function(t){return!(null==t||!t._isBuffer)},n.compare=function(t,e){if(!n.isBuffer(t)||!n.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var r=t.length,i=e.length,o=0,s=Math.min(r,i);s>o&&t[o]===e[o];)++o;return o!==s&&(r=t[o],i=e[o]),i>r?-1:r>i?1:0},n.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},n.concat=function(t,e){if(!G(t))throw new TypeError("list argument must be an Array of Buffers.");if(0===t.length)return new n(0);if(1===t.length)return t[0];var r;if(void 0===e)for(e=0,r=0;r<t.length;r++)e+=t[r].length;var i=new n(e),o=0;for(r=0;r<t.length;r++){var s=t[r];s.copy(i,o),o+=s.length}return i},n.byteLength=g,n.prototype.length=void 0,n.prototype.parent=void 0,n.prototype.toString=function(t,e,r){var n=!1;if(e=0|e,r=void 0===r||r===1/0?this.length:0|r,t||(t="utf8"),0>e&&(e=0),r>this.length&&(r=this.length),e>=r)return"";for(;;)switch(t){case"hex":return j(this,e,r);case"utf8":case"utf-8":return E(this,e,r);case"ascii":return M(this,e,r);case"binary":return k(this,e,r);case"base64":return _(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return R(this,e,r);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}},n.prototype.equals=function(t){if(!n.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t?!0:0===n.compare(this,t)},n.prototype.inspect=function(){var t="",e=r.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,e).match(/.{2}/g).join(" "),this.length>e&&(t+=" ... ")),"<Buffer "+t+">"},n.prototype.compare=function(t){if(!n.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t?0:n.compare(this,t)},n.prototype.indexOf=function(t,e){function r(t,e,r){for(var n=-1,i=0;r+i<t.length;i++)if(t[r+i]===e[-1===n?0:i-n]){if(-1===n&&(n=i),i-n+1===e.length)return r+n}else n=-1;return-1}if(e>2147483647?e=2147483647:-2147483648>e&&(e=-2147483648),e>>=0,0===this.length)return-1;if(e>=this.length)return-1;if(0>e&&(e=Math.max(this.length+e,0)),"string"==typeof t)return 0===t.length?-1:String.prototype.indexOf.call(this,t,e);if(n.isBuffer(t))return r(this,t,e);if("number"==typeof t)return n.TYPED_ARRAY_SUPPORT&&"function"===Uint8Array.prototype.indexOf?Uint8Array.prototype.indexOf.call(this,t,e):r(this,[t],e);throw new TypeError("val must be string, number or Buffer")},n.prototype.get=function(t){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(t)},n.prototype.set=function(t,e){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(t,e)},n.prototype.write=function(t,e,r,n){if(void 0===e)n="utf8",r=this.length,e=0;else if(void 0===r&&"string"==typeof e)n=e,r=this.length,e=0;else if(isFinite(e))e=0|e,isFinite(r)?(r=0|r,void 0===n&&(n="utf8")):(n=r,r=void 0);else{var i=n;n=e,e=0|r,r=i}var o=this.length-e;if((void 0===r||r>o)&&(r=o),t.length>0&&(0>r||0>e)||e>this.length)throw new RangeError("attempt to write outside buffer bounds");n||(n="utf8");for(var s=!1;;)switch(n){case"hex":return b(this,t,e,r);case"utf8":case"utf-8":return y(this,t,e,r);case"ascii":return m(this,t,e,r);case"binary":return w(this,t,e,r);case"base64":return v(this,t,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return x(this,t,e,r);default:if(s)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),s=!0}},n.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},n.prototype.slice=function(t,e){var r=this.length;t=~~t,e=void 0===e?r:~~e,0>t?(t+=r,0>t&&(t=0)):t>r&&(t=r),0>e?(e+=r,0>e&&(e=0)):e>r&&(e=r),t>e&&(e=t);var i;if(n.TYPED_ARRAY_SUPPORT)i=n._augment(this.subarray(t,e));else{var o=e-t;i=new n(o,void 0);for(var s=0;o>s;s++)i[s]=this[s+t]}return i.length&&(i.parent=this.parent||this),i},n.prototype.readUIntLE=function(t,e,r){t=0|t,e=0|e,r||A(t,e,this.length);for(var n=this[t],i=1,o=0;++o<e&&(i*=256);)n+=this[t+o]*i;return n},n.prototype.readUIntBE=function(t,e,r){t=0|t,e=0|e,r||A(t,e,this.length);for(var n=this[t+--e],i=1;e>0&&(i*=256);)n+=this[t+--e]*i;return n},n.prototype.readUInt8=function(t,e){return e||A(t,1,this.length),this[t]},n.prototype.readUInt16LE=function(t,e){return e||A(t,2,this.length),this[t]|this[t+1]<<8},n.prototype.readUInt16BE=function(t,e){return e||A(t,2,this.length),this[t]<<8|this[t+1]},n.prototype.readUInt32LE=function(t,e){return e||A(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},n.prototype.readUInt32BE=function(t,e){return e||A(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},n.prototype.readIntLE=function(t,e,r){t=0|t,e=0|e,r||A(t,e,this.length);for(var n=this[t],i=1,o=0;++o<e&&(i*=256);)n+=this[t+o]*i;return i*=128,n>=i&&(n-=Math.pow(2,8*e)),n},n.prototype.readIntBE=function(t,e,r){t=0|t,e=0|e,r||A(t,e,this.length);for(var n=e,i=1,o=this[t+--n];n>0&&(i*=256);)o+=this[t+--n]*i;return i*=128,o>=i&&(o-=Math.pow(2,8*e)),o},n.prototype.readInt8=function(t,e){return e||A(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},n.prototype.readInt16LE=function(t,e){e||A(t,2,this.length);var r=this[t]|this[t+1]<<8;return 32768&r?4294901760|r:r},n.prototype.readInt16BE=function(t,e){e||A(t,2,this.length);var r=this[t+1]|this[t]<<8;return 32768&r?4294901760|r:r},n.prototype.readInt32LE=function(t,e){return e||A(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},n.prototype.readInt32BE=function(t,e){return e||A(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},n.prototype.readFloatLE=function(t,e){return e||A(t,4,this.length),$.read(this,t,!0,23,4)},n.prototype.readFloatBE=function(t,e){return e||A(t,4,this.length),$.read(this,t,!1,23,4)},n.prototype.readDoubleLE=function(t,e){return e||A(t,8,this.length),$.read(this,t,!0,52,8)},n.prototype.readDoubleBE=function(t,e){return e||A(t,8,this.length),$.read(this,t,!1,52,8)},n.prototype.writeUIntLE=function(t,e,r,n){t=+t,e=0|e,r=0|r,n||L(this,t,e,r,Math.pow(2,8*r),0);var i=1,o=0;for(this[e]=255&t;++o<r&&(i*=256);)this[e+o]=t/i&255;return e+r},n.prototype.writeUIntBE=function(t,e,r,n){t=+t,e=0|e,r=0|r,n||L(this,t,e,r,Math.pow(2,8*r),0);var i=r-1,o=1;for(this[e+i]=255&t;--i>=0&&(o*=256);)this[e+i]=t/o&255;return e+r},n.prototype.writeUInt8=function(t,e,r){return t=+t,e=0|e,r||L(this,t,e,1,255,0),n.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=t,e+1},n.prototype.writeUInt16LE=function(t,e,r){return t=+t,e=0|e,r||L(this,t,e,2,65535,0),n.TYPED_ARRAY_SUPPORT?(this[e]=t,this[e+1]=t>>>8):S(this,t,e,!0),e+2},n.prototype.writeUInt16BE=function(t,e,r){return t=+t,e=0|e,r||L(this,t,e,2,65535,0),n.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=t):S(this,t,e,!1),e+2},n.prototype.writeUInt32LE=function(t,e,r){return t=+t,e=0|e,r||L(this,t,e,4,4294967295,0),n.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=t):T(this,t,e,!0),e+4},n.prototype.writeUInt32BE=function(t,e,r){return t=+t,e=0|e,r||L(this,t,e,4,4294967295,0),n.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=t):T(this,t,e,!1),e+4},n.prototype.writeIntLE=function(t,e,r,n){if(t=+t,e=0|e,!n){var i=Math.pow(2,8*r-1);L(this,t,e,r,i-1,-i)}var o=0,s=1,a=0>t?1:0;for(this[e]=255&t;++o<r&&(s*=256);)this[e+o]=(t/s>>0)-a&255;return e+r},n.prototype.writeIntBE=function(t,e,r,n){if(t=+t,e=0|e,!n){var i=Math.pow(2,8*r-1);L(this,t,e,r,i-1,-i)}var o=r-1,s=1,a=0>t?1:0;for(this[e+o]=255&t;--o>=0&&(s*=256);)this[e+o]=(t/s>>0)-a&255;return e+r},n.prototype.writeInt8=function(t,e,r){return t=+t,e=0|e,r||L(this,t,e,1,127,-128),n.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),0>t&&(t=255+t+1),this[e]=t,e+1},n.prototype.writeInt16LE=function(t,e,r){return t=+t,e=0|e,r||L(this,t,e,2,32767,-32768),n.TYPED_ARRAY_SUPPORT?(this[e]=t,this[e+1]=t>>>8):S(this,t,e,!0),e+2},n.prototype.writeInt16BE=function(t,e,r){return t=+t,e=0|e,r||L(this,t,e,2,32767,-32768),n.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=t):S(this,t,e,!1),e+2},n.prototype.writeInt32LE=function(t,e,r){return t=+t,e=0|e,r||L(this,t,e,4,2147483647,-2147483648),n.TYPED_ARRAY_SUPPORT?(this[e]=t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):T(this,t,e,!0),e+4},n.prototype.writeInt32BE=function(t,e,r){return t=+t,e=0|e,r||L(this,t,e,4,2147483647,-2147483648),0>t&&(t=4294967295+t+1),n.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=t):T(this,t,e,!1),e+4},n.prototype.writeFloatLE=function(t,e,r){return I(this,t,e,!0,r)},n.prototype.writeFloatBE=function(t,e,r){return I(this,t,e,!1,r)},n.prototype.writeDoubleLE=function(t,e,r){return O(this,t,e,!0,r)},n.prototype.writeDoubleBE=function(t,e,r){return O(this,t,e,!1,r)},n.prototype.copy=function(t,e,r,i){if(r||(r=0),i||0===i||(i=this.length),e>=t.length&&(e=t.length),e||(e=0),i>0&&r>i&&(i=r),i===r)return 0;if(0===t.length||0===this.length)return 0;if(0>e)throw new RangeError("targetStart out of bounds");if(0>r||r>=this.length)throw new RangeError("sourceStart out of bounds");if(0>i)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),t.length-e<i-r&&(i=t.length-e+r);var o=i-r;if(1e3>o||!n.TYPED_ARRAY_SUPPORT)for(var s=0;o>s;s++)t[s+e]=this[s+r];else t._set(this.subarray(r,r+o),e);return o},n.prototype.fill=function(t,e,r){if(t||(t=0),e||(e=0),r||(r=this.length),e>r)throw new RangeError("end < start");if(r!==e&&0!==this.length){if(0>e||e>=this.length)throw new RangeError("start out of bounds");if(0>r||r>this.length)throw new RangeError("end out of bounds");var n;if("number"==typeof t)for(n=e;r>n;n++)this[n]=t;else{var i=N(t.toString()),o=i.length;for(n=e;r>n;n++)this[n]=i[n%o]}return this}},n.prototype.toArrayBuffer=function(){if("undefined"!=typeof Uint8Array){if(n.TYPED_ARRAY_SUPPORT)return new n(this).buffer;for(var t=new Uint8Array(this.length),e=0,r=t.length;r>e;e+=1)t[e]=this[e];return t.buffer}throw new TypeError("Buffer.toArrayBuffer not supported in this browser")};var J=n.prototype;n._augment=function(t){return t.constructor=n,t._isBuffer=!0,t._set=t.set,t.get=J.get,t.set=J.set,t.write=J.write,t.toString=J.toString,t.toLocaleString=J.toString,t.toJSON=J.toJSON,t.equals=J.equals,t.compare=J.compare,t.indexOf=J.indexOf,t.copy=J.copy,t.slice=J.slice,t.readUIntLE=J.readUIntLE,t.readUIntBE=J.readUIntBE,t.readUInt8=J.readUInt8,t.readUInt16LE=J.readUInt16LE,t.readUInt16BE=J.readUInt16BE,t.readUInt32LE=J.readUInt32LE,t.readUInt32BE=J.readUInt32BE,t.readIntLE=J.readIntLE,t.readIntBE=J.readIntBE,t.readInt8=J.readInt8,t.readInt16LE=J.readInt16LE,t.readInt16BE=J.readInt16BE,t.readInt32LE=J.readInt32LE,t.readInt32BE=J.readInt32BE,t.readFloatLE=J.readFloatLE,t.readFloatBE=J.readFloatBE,t.readDoubleLE=J.readDoubleLE,t.readDoubleBE=J.readDoubleBE,t.writeUInt8=J.writeUInt8,t.writeUIntLE=J.writeUIntLE,t.writeUIntBE=J.writeUIntBE,t.writeUInt16LE=J.writeUInt16LE,t.writeUInt16BE=J.writeUInt16BE,t.writeUInt32LE=J.writeUInt32LE,t.writeUInt32BE=J.writeUInt32BE,t.writeIntLE=J.writeIntLE,t.writeIntBE=J.writeIntBE,t.writeInt8=J.writeInt8,t.writeInt16LE=J.writeInt16LE,t.writeInt16BE=J.writeInt16BE,t.writeInt32LE=J.writeInt32LE,t.writeInt32BE=J.writeInt32BE,t.writeFloatLE=J.writeFloatLE,t.writeFloatBE=J.writeFloatBE,t.writeDoubleLE=J.writeDoubleLE,t.writeDoubleBE=J.writeDoubleBE,t.fill=J.fill,t.inspect=J.inspect,t.toArrayBuffer=J.toArrayBuffer,t};var H=/[^+\/0-9A-z\-]/g},{"base64-js":3,ieee754:4,"is-array":5}],3:[function(t,e,r){var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";!function(t){"use strict";function e(t){var e=t.charCodeAt(0);return e===s||e===c?62:e===a||e===f?63:u>e?-1:u+10>e?e-u+26+26:l+26>e?e-l:h+26>e?e-h+26:void 0}function r(t){function r(t){h[c++]=t}var n,i,s,a,u,h;if(t.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var l=t.length;u="="===t.charAt(l-2)?2:"="===t.charAt(l-1)?1:0,h=new o(3*t.length/4-u),s=u>0?t.length-4:t.length;var c=0;for(n=0,i=0;s>n;n+=4,i+=3)a=e(t.charAt(n))<<18|e(t.charAt(n+1))<<12|e(t.charAt(n+2))<<6|e(t.charAt(n+3)),r((16711680&a)>>16),r((65280&a)>>8),r(255&a);return 2===u?(a=e(t.charAt(n))<<2|e(t.charAt(n+1))>>4,r(255&a)):1===u&&(a=e(t.charAt(n))<<10|e(t.charAt(n+1))<<4|e(t.charAt(n+2))>>2,r(a>>8&255),r(255&a)),h}function i(t){function e(t){return n.charAt(t)}function r(t){return e(t>>18&63)+e(t>>12&63)+e(t>>6&63)+e(63&t)}var i,o,s,a=t.length%3,u="";for(i=0,s=t.length-a;s>i;i+=3)o=(t[i]<<16)+(t[i+1]<<8)+t[i+2],u+=r(o);switch(a){case 1:o=t[t.length-1],u+=e(o>>2),u+=e(o<<4&63),u+="==";break;case 2:o=(t[t.length-2]<<8)+t[t.length-1],u+=e(o>>10),u+=e(o>>4&63),u+=e(o<<2&63),u+="="}return u}var o="undefined"!=typeof Uint8Array?Uint8Array:Array,s="+".charCodeAt(0),a="/".charCodeAt(0),u="0".charCodeAt(0),h="a".charCodeAt(0),l="A".charCodeAt(0),c="-".charCodeAt(0),f="_".charCodeAt(0);t.toByteArray=r,t.fromByteArray=i}("undefined"==typeof r?this.base64js={}:r)},{}],4:[function(t,e,r){r.read=function(t,e,r,n,i){var o,s,a=8*i-n-1,u=(1<<a)-1,h=u>>1,l=-7,c=r?i-1:0,f=r?-1:1,p=t[e+c];for(c+=f,o=p&(1<<-l)-1,p>>=-l,l+=a;l>0;o=256*o+t[e+c],c+=f,l-=8);for(s=o&(1<<-l)-1,o>>=-l,l+=n;l>0;s=256*s+t[e+c],c+=f,l-=8);if(0===o)o=1-h;else{if(o===u)return s?NaN:(p?-1:1)*(1/0);s+=Math.pow(2,n),o-=h}return(p?-1:1)*s*Math.pow(2,o-n)},r.write=function(t,e,r,n,i,o){var s,a,u,h=8*o-i-1,l=(1<<h)-1,c=l>>1,f=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:o-1,d=n?1:-1,g=0>e||0===e&&0>1/e?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=l):(s=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-s))<1&&(s--,u*=2),e+=s+c>=1?f/u:f*Math.pow(2,1-c),e*u>=2&&(s++,u/=2),s+c>=l?(a=0,s=l):s+c>=1?(a=(e*u-1)*Math.pow(2,i),s+=c):(a=e*Math.pow(2,c-1)*Math.pow(2,i),s=0));i>=8;t[r+p]=255&a,p+=d,a/=256,i-=8);for(s=s<<i|a,h+=i;h>0;t[r+p]=255&s,p+=d,s/=256,h-=8);t[r+p-d]|=128*g}},{}],5:[function(t,e,r){var n=Array.isArray,i=Object.prototype.toString;e.exports=n||function(t){return!!t&&"[object Array]"==i.call(t)}},{}],6:[function(t,e,r){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function i(t){return"function"==typeof t}function o(t){return"number"==typeof t}function s(t){return"object"==typeof t&&null!==t}function a(t){return void 0===t}e.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(t){if(!o(t)||0>t||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},n.prototype.emit=function(t){var e,r,n,o,u,h;if(this._events||(this._events={}),"error"===t&&(!this._events.error||s(this._events.error)&&!this._events.error.length)){if(e=arguments[1],e instanceof Error)throw e;throw TypeError('Uncaught, unspecified "error" event.')}if(r=this._events[t],a(r))return!1;if(i(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:for(n=arguments.length,o=new Array(n-1),u=1;n>u;u++)o[u-1]=arguments[u];r.apply(this,o)}else if(s(r)){for(n=arguments.length,o=new Array(n-1),u=1;n>u;u++)o[u-1]=arguments[u];for(h=r.slice(),n=h.length,u=0;n>u;u++)h[u].apply(this,o)}return!0},n.prototype.addListener=function(t,e){var r;if(!i(e))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,i(e.listener)?e.listener:e),this._events[t]?s(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,s(this._events[t])&&!this._events[t].warned){var r;r=a(this._maxListeners)?n.defaultMaxListeners:this._maxListeners,r&&r>0&&this._events[t].length>r&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),"function"==typeof console.trace&&console.trace())}return this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(t,e){function r(){this.removeListener(t,r),n||(n=!0,e.apply(this,arguments))}if(!i(e))throw TypeError("listener must be a function");var n=!1;return r.listener=e,this.on(t,r),this},n.prototype.removeListener=function(t,e){var r,n,o,a;if(!i(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(r=this._events[t],o=r.length,n=-1,r===e||i(r.listener)&&r.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(s(r)){for(a=o;a-->0;)if(r[a]===e||r[a].listener&&r[a].listener===e){n=a;break}if(0>n)return this;1===r.length?(r.length=0,delete this._events[t]):r.splice(n,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},n.prototype.removeAllListeners=function(t){var e,r;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(r=this._events[t],i(r))this.removeListener(t,r);else for(;r.length;)this.removeListener(t,r[r.length-1]);return delete this._events[t],this},n.prototype.listeners=function(t){var e;return e=this._events&&this._events[t]?i(this._events[t])?[this._events[t]]:this._events[t].slice():[]},n.listenerCount=function(t,e){var r;return r=t._events&&t._events[e]?i(t._events[e])?1:t._events[e].length:0}},{}],7:[function(t,e,r){"function"==typeof Object.create?e.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(t,e){t.super_=e;var r=function(){};r.prototype=e.prototype,t.prototype=new r,t.prototype.constructor=t}},{}],8:[function(t,e,r){e.exports=Array.isArray||function(t){return"[object Array]"==Object.prototype.toString.call(t)}},{}],9:[function(t,e,r){function n(){l=!1,a.length?h=a.concat(h):c=-1,h.length&&i()}function i(){if(!l){var t=setTimeout(n);l=!0;for(var e=h.length;e;){for(a=h,h=[];++c<e;)a[c].run();c=-1,e=h.length}a=null,l=!1,clearTimeout(t)}}function o(t,e){this.fun=t,this.array=e}function s(){}var a,u=e.exports={},h=[],l=!1,c=-1;u.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];h.push(new o(t,e)),1!==h.length||l||setTimeout(i,0)},o.prototype.run=function(){this.fun.apply(null,this.array)},u.title="browser",u.browser=!0,u.env={},u.argv=[],u.version="",u.versions={},u.on=s,u.addListener=s,u.once=s,u.off=s,u.removeListener=s,u.removeAllListeners=s,u.emit=s,u.binding=function(t){throw new Error("process.binding is not supported")},u.cwd=function(){return"/"},u.chdir=function(t){throw new Error("process.chdir is not supported")},u.umask=function(){return 0}},{}],10:[function(t,e,r){e.exports=t("./lib/_stream_duplex.js")},{"./lib/_stream_duplex.js":11}],11:[function(t,e,r){(function(r){function n(t){return this instanceof n?(u.call(this,t),h.call(this,t),t&&t.readable===!1&&(this.readable=!1),t&&t.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,t&&t.allowHalfOpen===!1&&(this.allowHalfOpen=!1),void this.once("end",i)):new n(t)}function i(){this.allowHalfOpen||this._writableState.ended||r.nextTick(this.end.bind(this))}function o(t,e){for(var r=0,n=t.length;n>r;r++)e(t[r],r)}e.exports=n;var s=Object.keys||function(t){var e=[];for(var r in t)e.push(r);return e},a=t("core-util-is");a.inherits=t("inherits");var u=t("./_stream_readable"),h=t("./_stream_writable");a.inherits(n,u),o(s(h.prototype),function(t){n.prototype[t]||(n.prototype[t]=h.prototype[t])})}).call(this,t("_process"))},{"./_stream_readable":13,"./_stream_writable":15,_process:9,"core-util-is":16,inherits:7}],12:[function(t,e,r){function n(t){return this instanceof n?void i.call(this,t):new n(t)}e.exports=n;var i=t("./_stream_transform"),o=t("core-util-is");o.inherits=t("inherits"),o.inherits(n,i),n.prototype._transform=function(t,e,r){r(null,t)}},{"./_stream_transform":14,"core-util-is":16,inherits:7}],13:[function(t,e,r){(function(r){function n(e,r){var n=t("./_stream_duplex");e=e||{};var i=e.highWaterMark,o=e.objectMode?16:16384;this.highWaterMark=i||0===i?i:o,this.highWaterMark=~~this.highWaterMark,this.buffer=[],this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.objectMode=!!e.objectMode,r instanceof n&&(this.objectMode=this.objectMode||!!e.readableObjectMode),this.defaultEncoding=e.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(A||(A=t("string_decoder/").StringDecoder),this.decoder=new A(e.encoding),this.encoding=e.encoding)}function i(e){t("./_stream_duplex");return this instanceof i?(this._readableState=new n(e,this),this.readable=!0,void j.call(this)):new i(e)}function o(t,e,r,n,i){var o=h(e,r);if(o)t.emit("error",o);else if(R.isNullOrUndefined(r))e.reading=!1,e.ended||l(t,e);else if(e.objectMode||r&&r.length>0)if(e.ended&&!i){var a=new Error("stream.push() after EOF");t.emit("error",a)}else if(e.endEmitted&&i){var a=new Error("stream.unshift() after end event");t.emit("error",a)}else!e.decoder||i||n||(r=e.decoder.write(r)),i||(e.reading=!1),e.flowing&&0===e.length&&!e.sync?(t.emit("data",r),t.read(0)):(e.length+=e.objectMode?1:r.length,i?e.buffer.unshift(r):e.buffer.push(r),e.needReadable&&c(t)),p(t,e);else i||(e.reading=!1);return s(e)}function s(t){return!t.ended&&(t.needReadable||t.length<t.highWaterMark||0===t.length)}function a(t){if(t>=S)t=S;else{t--;for(var e=1;32>e;e<<=1)t|=t>>e;t++}return t}function u(t,e){return 0===e.length&&e.ended?0:e.objectMode?0===t?0:1:isNaN(t)||R.isNull(t)?e.flowing&&e.buffer.length?e.buffer[0].length:e.length:0>=t?0:(t>e.highWaterMark&&(e.highWaterMark=a(t)),t>e.length?e.ended?e.length:(e.needReadable=!0,0):t)}function h(t,e){var r=null;return R.isBuffer(e)||R.isString(e)||R.isNullOrUndefined(e)||t.objectMode||(r=new TypeError("Invalid non-string/buffer chunk")),r}function l(t,e){if(e.decoder&&!e.ended){var r=e.decoder.end();r&&r.length&&(e.buffer.push(r),e.length+=e.objectMode?1:r.length)}e.ended=!0,c(t)}function c(t){var e=t._readableState;e.needReadable=!1,e.emittedReadable||(L("emitReadable",e.flowing),e.emittedReadable=!0,e.sync?r.nextTick(function(){f(t)}):f(t))}function f(t){L("emit readable"),t.emit("readable"),m(t)}function p(t,e){e.readingMore||(e.readingMore=!0,r.nextTick(function(){d(t,e)}))}function d(t,e){for(var r=e.length;!e.reading&&!e.flowing&&!e.ended&&e.length<e.highWaterMark&&(L("maybeReadMore read 0"),t.read(0),r!==e.length);)r=e.length;e.readingMore=!1}function g(t){return function(){var e=t._readableState;L("pipeOnDrain",e.awaitDrain),e.awaitDrain&&e.awaitDrain--,0===e.awaitDrain&&k.listenerCount(t,"data")&&(e.flowing=!0,m(t))}}function b(t,e){e.resumeScheduled||(e.resumeScheduled=!0,r.nextTick(function(){y(t,e)}))}function y(t,e){e.resumeScheduled=!1,t.emit("resume"),m(t),e.flowing&&!e.reading&&t.read(0)}function m(t){var e=t._readableState;if(L("flow",e.flowing),e.flowing)do var r=t.read();while(null!==r&&e.flowing)}function w(t,e){var r,n=e.buffer,i=e.length,o=!!e.decoder,s=!!e.objectMode;if(0===n.length)return null;if(0===i)r=null;else if(s)r=n.shift();else if(!t||t>=i)r=o?n.join(""):M.concat(n,i),n.length=0;else if(t<n[0].length){var a=n[0];r=a.slice(0,t),n[0]=a.slice(t)}else if(t===n[0].length)r=n.shift();else{r=o?"":new M(t);for(var u=0,h=0,l=n.length;l>h&&t>u;h++){var a=n[0],c=Math.min(t-u,a.length);o?r+=a.slice(0,c):a.copy(r,u,0,c),c<a.length?n[0]=a.slice(c):n.shift(),u+=c}}return r}function v(t){var e=t._readableState;if(e.length>0)throw new Error("endReadable called on non-empty stream");e.endEmitted||(e.ended=!0,r.nextTick(function(){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}))}function x(t,e){for(var r=0,n=t.length;n>r;r++)e(t[r],r)}function _(t,e){for(var r=0,n=t.length;n>r;r++)if(t[r]===e)return r;return-1}e.exports=i;var E=t("isarray"),M=t("buffer").Buffer;i.ReadableState=n;var k=t("events").EventEmitter;k.listenerCount||(k.listenerCount=function(t,e){return t.listeners(e).length});var j=t("stream"),R=t("core-util-is");R.inherits=t("inherits");var A,L=t("util");L=L&&L.debuglog?L.debuglog("stream"):function(){},R.inherits(i,j),i.prototype.push=function(t,e){var r=this._readableState;return R.isString(t)&&!r.objectMode&&(e=e||r.defaultEncoding,e!==r.encoding&&(t=new M(t,e),e="")),o(this,r,t,e,!1)},i.prototype.unshift=function(t){var e=this._readableState;return o(this,e,t,"",!0)},i.prototype.setEncoding=function(e){return A||(A=t("string_decoder/").StringDecoder),this._readableState.decoder=new A(e),this._readableState.encoding=e,this};var S=8388608;i.prototype.read=function(t){L("read",t);var e=this._readableState,r=t;if((!R.isNumber(t)||t>0)&&(e.emittedReadable=!1),0===t&&e.needReadable&&(e.length>=e.highWaterMark||e.ended))return L("read: emitReadable",e.length,e.ended),0===e.length&&e.ended?v(this):c(this),null;if(t=u(t,e),0===t&&e.ended)return 0===e.length&&v(this),null;var n=e.needReadable;L("need readable",n),(0===e.length||e.length-t<e.highWaterMark)&&(n=!0,
L("length less than watermark",n)),(e.ended||e.reading)&&(n=!1,L("reading or ended",n)),n&&(L("do read"),e.reading=!0,e.sync=!0,0===e.length&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1),n&&!e.reading&&(t=u(r,e));var i;return i=t>0?w(t,e):null,R.isNull(i)&&(e.needReadable=!0,t=0),e.length-=t,0!==e.length||e.ended||(e.needReadable=!0),r!==t&&e.ended&&0===e.length&&v(this),R.isNull(i)||this.emit("data",i),i},i.prototype._read=function(t){this.emit("error",new Error("not implemented"))},i.prototype.pipe=function(t,e){function n(t){L("onunpipe"),t===c&&o()}function i(){L("onend"),t.end()}function o(){L("cleanup"),t.removeListener("close",u),t.removeListener("finish",h),t.removeListener("drain",b),t.removeListener("error",a),t.removeListener("unpipe",n),c.removeListener("end",i),c.removeListener("end",o),c.removeListener("data",s),!f.awaitDrain||t._writableState&&!t._writableState.needDrain||b()}function s(e){L("ondata");var r=t.write(e);!1===r&&(L("false write response, pause",c._readableState.awaitDrain),c._readableState.awaitDrain++,c.pause())}function a(e){L("onerror",e),l(),t.removeListener("error",a),0===k.listenerCount(t,"error")&&t.emit("error",e)}function u(){t.removeListener("finish",h),l()}function h(){L("onfinish"),t.removeListener("close",u),l()}function l(){L("unpipe"),c.unpipe(t)}var c=this,f=this._readableState;switch(f.pipesCount){case 0:f.pipes=t;break;case 1:f.pipes=[f.pipes,t];break;default:f.pipes.push(t)}f.pipesCount+=1,L("pipe count=%d opts=%j",f.pipesCount,e);var p=(!e||e.end!==!1)&&t!==r.stdout&&t!==r.stderr,d=p?i:o;f.endEmitted?r.nextTick(d):c.once("end",d),t.on("unpipe",n);var b=g(c);return t.on("drain",b),c.on("data",s),t._events&&t._events.error?E(t._events.error)?t._events.error.unshift(a):t._events.error=[a,t._events.error]:t.on("error",a),t.once("close",u),t.once("finish",h),t.emit("pipe",c),f.flowing||(L("pipe resume"),c.resume()),t},i.prototype.unpipe=function(t){var e=this._readableState;if(0===e.pipesCount)return this;if(1===e.pipesCount)return t&&t!==e.pipes?this:(t||(t=e.pipes),e.pipes=null,e.pipesCount=0,e.flowing=!1,t&&t.emit("unpipe",this),this);if(!t){var r=e.pipes,n=e.pipesCount;e.pipes=null,e.pipesCount=0,e.flowing=!1;for(var i=0;n>i;i++)r[i].emit("unpipe",this);return this}var i=_(e.pipes,t);return-1===i?this:(e.pipes.splice(i,1),e.pipesCount-=1,1===e.pipesCount&&(e.pipes=e.pipes[0]),t.emit("unpipe",this),this)},i.prototype.on=function(t,e){var n=j.prototype.on.call(this,t,e);if("data"===t&&!1!==this._readableState.flowing&&this.resume(),"readable"===t&&this.readable){var i=this._readableState;if(!i.readableListening)if(i.readableListening=!0,i.emittedReadable=!1,i.needReadable=!0,i.reading)i.length&&c(this,i);else{var o=this;r.nextTick(function(){L("readable nexttick read 0"),o.read(0)})}}return n},i.prototype.addListener=i.prototype.on,i.prototype.resume=function(){var t=this._readableState;return t.flowing||(L("resume"),t.flowing=!0,t.reading||(L("resume read 0"),this.read(0)),b(this,t)),this},i.prototype.pause=function(){return L("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(L("pause"),this._readableState.flowing=!1,this.emit("pause")),this},i.prototype.wrap=function(t){var e=this._readableState,r=!1,n=this;t.on("end",function(){if(L("wrapped end"),e.decoder&&!e.ended){var t=e.decoder.end();t&&t.length&&n.push(t)}n.push(null)}),t.on("data",function(i){if(L("wrapped data"),e.decoder&&(i=e.decoder.write(i)),i&&(e.objectMode||i.length)){var o=n.push(i);o||(r=!0,t.pause())}});for(var i in t)R.isFunction(t[i])&&R.isUndefined(this[i])&&(this[i]=function(e){return function(){return t[e].apply(t,arguments)}}(i));var o=["error","close","destroy","pause","resume"];return x(o,function(e){t.on(e,n.emit.bind(n,e))}),n._read=function(e){L("wrapped _read",e),r&&(r=!1,t.resume())},n},i._fromList=w}).call(this,t("_process"))},{"./_stream_duplex":11,_process:9,buffer:2,"core-util-is":16,events:6,inherits:7,isarray:8,stream:21,"string_decoder/":22,util:1}],14:[function(t,e,r){function n(t,e){this.afterTransform=function(t,r){return i(e,t,r)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null}function i(t,e,r){var n=t._transformState;n.transforming=!1;var i=n.writecb;if(!i)return t.emit("error",new Error("no writecb in Transform class"));n.writechunk=null,n.writecb=null,u.isNullOrUndefined(r)||t.push(r),i&&i(e);var o=t._readableState;o.reading=!1,(o.needReadable||o.length<o.highWaterMark)&&t._read(o.highWaterMark)}function o(t){if(!(this instanceof o))return new o(t);a.call(this,t),this._transformState=new n(t,this);var e=this;this._readableState.needReadable=!0,this._readableState.sync=!1,this.once("prefinish",function(){u.isFunction(this._flush)?this._flush(function(t){s(e,t)}):s(e)})}function s(t,e){if(e)return t.emit("error",e);var r=t._writableState,n=t._transformState;if(r.length)throw new Error("calling transform done when ws.length != 0");if(n.transforming)throw new Error("calling transform done when still transforming");return t.push(null)}e.exports=o;var a=t("./_stream_duplex"),u=t("core-util-is");u.inherits=t("inherits"),u.inherits(o,a),o.prototype.push=function(t,e){return this._transformState.needTransform=!1,a.prototype.push.call(this,t,e)},o.prototype._transform=function(t,e,r){throw new Error("not implemented")},o.prototype._write=function(t,e,r){var n=this._transformState;if(n.writecb=r,n.writechunk=t,n.writeencoding=e,!n.transforming){var i=this._readableState;(n.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},o.prototype._read=function(t){var e=this._transformState;u.isNull(e.writechunk)||!e.writecb||e.transforming?e.needTransform=!0:(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform))}},{"./_stream_duplex":11,"core-util-is":16,inherits:7}],15:[function(t,e,r){(function(r){function n(t,e,r){this.chunk=t,this.encoding=e,this.callback=r}function i(e,r){var n=t("./_stream_duplex");e=e||{};var i=e.highWaterMark,o=e.objectMode?16:16384;this.highWaterMark=i||0===i?i:o,this.objectMode=!!e.objectMode,r instanceof n&&(this.objectMode=this.objectMode||!!e.writableObjectMode),this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var s=e.decodeStrings===!1;this.decodeStrings=!s,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(t){p(r,t)},this.writecb=null,this.writelen=0,this.buffer=[],this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1}function o(e){var r=t("./_stream_duplex");return this instanceof o||this instanceof r?(this._writableState=new i(e,this),this.writable=!0,void E.call(this)):new o(e)}function s(t,e,n){var i=new Error("write after end");t.emit("error",i),r.nextTick(function(){n(i)})}function a(t,e,n,i){var o=!0;if(!(_.isBuffer(n)||_.isString(n)||_.isNullOrUndefined(n)||e.objectMode)){var s=new TypeError("Invalid non-string/buffer chunk");t.emit("error",s),r.nextTick(function(){i(s)}),o=!1}return o}function u(t,e,r){return!t.objectMode&&t.decodeStrings!==!1&&_.isString(e)&&(e=new x(e,r)),e}function h(t,e,r,i,o){r=u(e,r,i),_.isBuffer(r)&&(i="buffer");var s=e.objectMode?1:r.length;e.length+=s;var a=e.length<e.highWaterMark;return a||(e.needDrain=!0),e.writing||e.corked?e.buffer.push(new n(r,i,o)):l(t,e,!1,s,r,i,o),a}function l(t,e,r,n,i,o,s){e.writelen=n,e.writecb=s,e.writing=!0,e.sync=!0,r?t._writev(i,e.onwrite):t._write(i,o,e.onwrite),e.sync=!1}function c(t,e,n,i,o){n?r.nextTick(function(){e.pendingcb--,o(i)}):(e.pendingcb--,o(i)),t._writableState.errorEmitted=!0,t.emit("error",i)}function f(t){t.writing=!1,t.writecb=null,t.length-=t.writelen,t.writelen=0}function p(t,e){var n=t._writableState,i=n.sync,o=n.writecb;if(f(n),e)c(t,n,i,e,o);else{var s=y(t,n);s||n.corked||n.bufferProcessing||!n.buffer.length||b(t,n),i?r.nextTick(function(){d(t,n,s,o)}):d(t,n,s,o)}}function d(t,e,r,n){r||g(t,e),e.pendingcb--,n(),w(t,e)}function g(t,e){0===e.length&&e.needDrain&&(e.needDrain=!1,t.emit("drain"))}function b(t,e){if(e.bufferProcessing=!0,t._writev&&e.buffer.length>1){for(var r=[],n=0;n<e.buffer.length;n++)r.push(e.buffer[n].callback);e.pendingcb++,l(t,e,!0,e.length,e.buffer,"",function(t){for(var n=0;n<r.length;n++)e.pendingcb--,r[n](t)}),e.buffer=[]}else{for(var n=0;n<e.buffer.length;n++){var i=e.buffer[n],o=i.chunk,s=i.encoding,a=i.callback,u=e.objectMode?1:o.length;if(l(t,e,!1,u,o,s,a),e.writing){n++;break}}n<e.buffer.length?e.buffer=e.buffer.slice(n):e.buffer.length=0}e.bufferProcessing=!1}function y(t,e){return e.ending&&0===e.length&&!e.finished&&!e.writing}function m(t,e){e.prefinished||(e.prefinished=!0,t.emit("prefinish"))}function w(t,e){var r=y(t,e);return r&&(0===e.pendingcb?(m(t,e),e.finished=!0,t.emit("finish")):m(t,e)),r}function v(t,e,n){e.ending=!0,w(t,e),n&&(e.finished?r.nextTick(n):t.once("finish",n)),e.ended=!0}e.exports=o;var x=t("buffer").Buffer;o.WritableState=i;var _=t("core-util-is");_.inherits=t("inherits");var E=t("stream");_.inherits(o,E),o.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe. Not readable."))},o.prototype.write=function(t,e,r){var n=this._writableState,i=!1;return _.isFunction(e)&&(r=e,e=null),_.isBuffer(t)?e="buffer":e||(e=n.defaultEncoding),_.isFunction(r)||(r=function(){}),n.ended?s(this,n,r):a(this,n,t,r)&&(n.pendingcb++,i=h(this,n,t,e,r)),i},o.prototype.cork=function(){var t=this._writableState;t.corked++},o.prototype.uncork=function(){var t=this._writableState;t.corked&&(t.corked--,t.writing||t.corked||t.finished||t.bufferProcessing||!t.buffer.length||b(this,t))},o.prototype._write=function(t,e,r){r(new Error("not implemented"))},o.prototype._writev=null,o.prototype.end=function(t,e,r){var n=this._writableState;_.isFunction(t)?(r=t,t=null,e=null):_.isFunction(e)&&(r=e,e=null),_.isNullOrUndefined(t)||this.write(t,e),n.corked&&(n.corked=1,this.uncork()),n.ending||n.finished||v(this,n,r)}}).call(this,t("_process"))},{"./_stream_duplex":11,_process:9,buffer:2,"core-util-is":16,inherits:7,stream:21}],16:[function(t,e,r){(function(t){function e(t){return Array.isArray(t)}function n(t){return"boolean"==typeof t}function i(t){return null===t}function o(t){return null==t}function s(t){return"number"==typeof t}function a(t){return"string"==typeof t}function u(t){return"symbol"==typeof t}function h(t){return void 0===t}function l(t){return c(t)&&"[object RegExp]"===y(t)}function c(t){return"object"==typeof t&&null!==t}function f(t){return c(t)&&"[object Date]"===y(t)}function p(t){return c(t)&&("[object Error]"===y(t)||t instanceof Error)}function d(t){return"function"==typeof t}function g(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||"undefined"==typeof t}function b(e){return t.isBuffer(e)}function y(t){return Object.prototype.toString.call(t)}r.isArray=e,r.isBoolean=n,r.isNull=i,r.isNullOrUndefined=o,r.isNumber=s,r.isString=a,r.isSymbol=u,r.isUndefined=h,r.isRegExp=l,r.isObject=c,r.isDate=f,r.isError=p,r.isFunction=d,r.isPrimitive=g,r.isBuffer=b}).call(this,t("buffer").Buffer)},{buffer:2}],17:[function(t,e,r){e.exports=t("./lib/_stream_passthrough.js")},{"./lib/_stream_passthrough.js":12}],18:[function(t,e,r){r=e.exports=t("./lib/_stream_readable.js"),r.Stream=t("stream"),r.Readable=r,r.Writable=t("./lib/_stream_writable.js"),r.Duplex=t("./lib/_stream_duplex.js"),r.Transform=t("./lib/_stream_transform.js"),r.PassThrough=t("./lib/_stream_passthrough.js")},{"./lib/_stream_duplex.js":11,"./lib/_stream_passthrough.js":12,"./lib/_stream_readable.js":13,"./lib/_stream_transform.js":14,"./lib/_stream_writable.js":15,stream:21}],19:[function(t,e,r){e.exports=t("./lib/_stream_transform.js")},{"./lib/_stream_transform.js":14}],20:[function(t,e,r){e.exports=t("./lib/_stream_writable.js")},{"./lib/_stream_writable.js":15}],21:[function(t,e,r){function n(){i.call(this)}e.exports=n;var i=t("events").EventEmitter,o=t("inherits");o(n,i),n.Readable=t("readable-stream/readable.js"),n.Writable=t("readable-stream/writable.js"),n.Duplex=t("readable-stream/duplex.js"),n.Transform=t("readable-stream/transform.js"),n.PassThrough=t("readable-stream/passthrough.js"),n.Stream=n,n.prototype.pipe=function(t,e){function r(e){t.writable&&!1===t.write(e)&&h.pause&&h.pause()}function n(){h.readable&&h.resume&&h.resume()}function o(){l||(l=!0,t.end())}function s(){l||(l=!0,"function"==typeof t.destroy&&t.destroy())}function a(t){if(u(),0===i.listenerCount(this,"error"))throw t}function u(){h.removeListener("data",r),t.removeListener("drain",n),h.removeListener("end",o),h.removeListener("close",s),h.removeListener("error",a),t.removeListener("error",a),h.removeListener("end",u),h.removeListener("close",u),t.removeListener("close",u)}var h=this;h.on("data",r),t.on("drain",n),t._isStdio||e&&e.end===!1||(h.on("end",o),h.on("close",s));var l=!1;return h.on("error",a),t.on("error",a),h.on("end",u),h.on("close",u),t.on("close",u),t.emit("pipe",h),t}},{events:6,inherits:7,"readable-stream/duplex.js":10,"readable-stream/passthrough.js":17,"readable-stream/readable.js":18,"readable-stream/transform.js":19,"readable-stream/writable.js":20}],22:[function(t,e,r){function n(t){if(t&&!u(t))throw new Error("Unknown encoding: "+t)}function i(t){return t.toString(this.encoding)}function o(t){this.charReceived=t.length%2,this.charLength=this.charReceived?2:0}function s(t){this.charReceived=t.length%3,this.charLength=this.charReceived?3:0}var a=t("buffer").Buffer,u=a.isEncoding||function(t){switch(t&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}},h=r.StringDecoder=function(t){switch(this.encoding=(t||"utf8").toLowerCase().replace(/[-_]/,""),n(t),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=o;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=s;break;default:return void(this.write=i)}this.charBuffer=new a(6),this.charReceived=0,this.charLength=0};h.prototype.write=function(t){for(var e="";this.charLength;){var r=t.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:t.length;if(t.copy(this.charBuffer,this.charReceived,0,r),this.charReceived+=r,this.charReceived<this.charLength)return"";t=t.slice(r,t.length),e=this.charBuffer.slice(0,this.charLength).toString(this.encoding);var n=e.charCodeAt(e.length-1);if(!(n>=55296&&56319>=n)){if(this.charReceived=this.charLength=0,0===t.length)return e;break}this.charLength+=this.surrogateSize,e=""}this.detectIncompleteChar(t);var i=t.length;this.charLength&&(t.copy(this.charBuffer,0,t.length-this.charReceived,i),i-=this.charReceived),e+=t.toString(this.encoding,0,i);var i=e.length-1,n=e.charCodeAt(i);if(n>=55296&&56319>=n){var o=this.surrogateSize;return this.charLength+=o,this.charReceived+=o,this.charBuffer.copy(this.charBuffer,o,0,o),t.copy(this.charBuffer,0,0,o),e.substring(0,i)}return e},h.prototype.detectIncompleteChar=function(t){for(var e=t.length>=3?3:t.length;e>0;e--){var r=t[t.length-e];if(1==e&&r>>5==6){this.charLength=2;break}if(2>=e&&r>>4==14){this.charLength=3;break}if(3>=e&&r>>3==30){this.charLength=4;break}}this.charReceived=e},h.prototype.end=function(t){var e="";if(t&&t.length&&(e=this.write(t)),this.charReceived){var r=this.charReceived,n=this.charBuffer,i=this.encoding;e+=n.slice(0,r).toString(i)}return e}},{buffer:2}],23:[function(t,e,r){function n(t,e,r){var n=a(t)?i:s;return e=o(e,r,3),n(t,e)}var i=t("lodash._arrayfilter"),o=t("lodash._basecallback"),s=t("lodash._basefilter"),a=t("lodash.isarray");e.exports=n},{"lodash._arrayfilter":24,"lodash._basecallback":25,"lodash._basefilter":30,"lodash.isarray":32}],24:[function(t,e,r){function n(t,e){for(var r=-1,n=t.length,i=-1,o=[];++r<n;){var s=t[r];e(s,r,t)&&(o[++i]=s)}return o}e.exports=n},{}],25:[function(t,e,r){function n(t){return"string"==typeof t?t:null==t?"":t+""}function i(t,e,r){var n=typeof t;return"function"==n?void 0===e?t:_(t,e,r):null==t?w:"object"==n?a(t):void 0===e?v(t):u(t,e)}function o(t,e,r){if(null!=t){void 0!==r&&r in g(t)&&(e=[r]);for(var n=0,i=e.length;null!=t&&i>n;)t=t[e[n++]];return n&&n==i?t:void 0}}function s(t,e,r){var n=e.length,i=n,o=!r;if(null==t)return!i;for(t=g(t);n--;){var s=e[n];if(o&&s[2]?s[1]!==t[s[0]]:!(s[0]in t))return!1}for(;++n<i;){s=e[n];var a=s[0],u=t[a],h=s[1];if(o&&s[2]){if(void 0===u&&!(a in t))return!1}else{var l=r?r(u,h,a):void 0;if(!(void 0===l?x(h,u,r,!0):l))return!1}}return!0}function a(t){var e=f(t);if(1==e.length&&e[0][2]){var r=e[0][0],n=e[0][1];return function(t){return null==t?!1:t[r]===n&&(void 0!==n||r in g(t))}}return function(t){return s(t,e)}}function u(t,e){var r=E(t),n=p(t)&&d(e),i=t+"";return t=b(t),function(s){if(null==s)return!1;var a=i;if(s=g(s),!(!r&&n||a in s)){if(s=1==t.length?s:o(s,c(t,0,-1)),null==s)return!1;a=y(t),s=g(s)}return s[a]===e?void 0!==e||a in s:x(e,s[a],void 0,!0)}}function h(t){return function(e){return null==e?void 0:e[t]}}function l(t){var e=t+"";return t=b(t),function(r){return o(r,t,e)}}function c(t,e,r){var n=-1,i=t.length;e=null==e?0:+e||0,0>e&&(e=-e>i?0:i+e),r=void 0===r||r>i?i:+r||0,0>r&&(r+=i),i=e>r?0:r-e>>>0,e>>>=0;for(var o=Array(i);++n<i;)o[n]=t[n+e];return o}function f(t){for(var e=M(t),r=e.length;r--;)e[r][2]=d(e[r][1]);return e}function p(t,e){var r=typeof t;if("string"==r&&j.test(t)||"number"==r)return!0;if(E(t))return!1;var n=!k.test(t);return n||null!=e&&t in g(e)}function d(t){return t===t&&!m(t)}function g(t){return m(t)?t:Object(t)}function b(t){if(E(t))return t;var e=[];return n(t).replace(R,function(t,r,n,i){e.push(n?i.replace(A,"$1"):r||t)}),e}function y(t){var e=t?t.length:0;return e?t[e-1]:void 0}function m(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function w(t){return t}function v(t){return p(t)?h(t):l(t)}var x=t("lodash._baseisequal"),_=t("lodash._bindcallback"),E=t("lodash.isarray"),M=t("lodash.pairs"),k=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\n\\]|\\.)*?\1)\]/,j=/^\w*$/,R=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\n\\]|\\.)*?)\2)\]/g,A=/\\(\\)?/g;e.exports=i},{"lodash._baseisequal":26,"lodash._bindcallback":28,"lodash.isarray":32,"lodash.pairs":29}],26:[function(t,e,r){function n(t){return!!t&&"object"==typeof t}function i(t,e){for(var r=-1,n=t.length;++r<n;)if(e(t[r],r,t))return!0;return!1}function o(t,e,r,i,a,u){return t===e?!0:null==t||null==e||!l(t)&&!n(e)?t!==t&&e!==e:s(t,e,o,r,i,a,u)}function s(t,e,r,n,i,o,s){var l=c(t),p=c(e),b=g,y=g;l||(b=k.call(t),b==d?b=v:b!=v&&(l=f(t))),p||(y=k.call(e),y==d?y=v:y!=v&&(p=f(e)));var m=b==v,w=y==v,x=b==y;if(x&&!l&&!m)return u(t,e,b);if(!i){var _=m&&M.call(t,"__wrapped__"),E=w&&M.call(e,"__wrapped__");if(_||E)return r(_?t.value():t,E?e.value():e,n,i,o,s)}if(!x)return!1;o||(o=[]),s||(s=[]);for(var j=o.length;j--;)if(o[j]==t)return s[j]==e;o.push(t),s.push(e);var R=(l?a:h)(t,e,r,n,i,o,s);return o.pop(),s.pop(),R}function a(t,e,r,n,o,s,a){var u=-1,h=t.length,l=e.length;if(h!=l&&!(o&&l>h))return!1;for(;++u<h;){var c=t[u],f=e[u],p=n?n(o?f:c,o?c:f,u):void 0;if(void 0!==p){if(p)continue;return!1}if(o){if(!i(e,function(t){return c===t||r(c,t,n,o,s,a)}))return!1}else if(c!==f&&!r(c,f,n,o,s,a))return!1}return!0}function u(t,e,r){switch(r){case b:case y:return+t==+e;case m:return t.name==e.name&&t.message==e.message;case w:return t!=+t?e!=+e:t==+e;case x:case _:return t==e+""}return!1}function h(t,e,r,n,i,o,s){var a=p(t),u=a.length,h=p(e),l=h.length;if(u!=l&&!i)return!1;for(var c=u;c--;){var f=a[c];if(!(i?f in e:M.call(e,f)))return!1}for(var d=i;++c<u;){f=a[c];var g=t[f],b=e[f],y=n?n(i?b:g,i?g:b,f):void 0;if(!(void 0===y?r(g,b,n,i,o,s):y))return!1;d||(d="constructor"==f)}if(!d){var m=t.constructor,w=e.constructor;if(m!=w&&"constructor"in t&&"constructor"in e&&!("function"==typeof m&&m instanceof m&&"function"==typeof w&&w instanceof w))return!1}return!0}function l(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}var c=t("lodash.isarray"),f=t("lodash.istypedarray"),p=t("lodash.keys"),d="[object Arguments]",g="[object Array]",b="[object Boolean]",y="[object Date]",m="[object Error]",w="[object Number]",v="[object Object]",x="[object RegExp]",_="[object String]",E=Object.prototype,M=E.hasOwnProperty,k=E.toString;e.exports=o},{"lodash.isarray":32,"lodash.istypedarray":27,"lodash.keys":33}],27:[function(t,e,r){function n(t){return!!t&&"object"==typeof t}function i(t){return"number"==typeof t&&t>-1&&t%1==0&&B>=t}function o(t){return n(t)&&i(t.length)&&!!L[T.call(t)]}var s="[object Arguments]",a="[object Array]",u="[object Boolean]",h="[object Date]",l="[object Error]",c="[object Function]",f="[object Map]",p="[object Number]",d="[object Object]",g="[object RegExp]",b="[object Set]",y="[object String]",m="[object WeakMap]",w="[object ArrayBuffer]",v="[object Float32Array]",x="[object Float64Array]",_="[object Int8Array]",E="[object Int16Array]",M="[object Int32Array]",k="[object Uint8Array]",j="[object Uint8ClampedArray]",R="[object Uint16Array]",A="[object Uint32Array]",L={};L[v]=L[x]=L[_]=L[E]=L[M]=L[k]=L[j]=L[R]=L[A]=!0,L[s]=L[a]=L[w]=L[u]=L[h]=L[l]=L[c]=L[f]=L[p]=L[d]=L[g]=L[b]=L[y]=L[m]=!1;var S=Object.prototype,T=S.toString,B=9007199254740991;e.exports=o},{}],28:[function(t,e,r){function n(t,e,r){if("function"!=typeof t)return i;if(void 0===e)return t;switch(r){case 1:return function(r){return t.call(e,r)};case 3:return function(r,n,i){return t.call(e,r,n,i)};case 4:return function(r,n,i,o){return t.call(e,r,n,i,o)};case 5:return function(r,n,i,o,s){return t.call(e,r,n,i,o,s)}}return function(){return t.apply(e,arguments)}}function i(t){return t}e.exports=n},{}],29:[function(t,e,r){function n(t){return i(t)?t:Object(t)}function i(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function o(t){t=n(t);for(var e=-1,r=s(t),i=r.length,o=Array(i);++e<i;){var a=r[e];o[e]=[a,t[a]]}return o}var s=t("lodash.keys");e.exports=o},{"lodash.keys":33}],30:[function(t,e,r){function n(t,e){var r=[];return i(t,function(t,n,i){e(t,n,i)&&r.push(t)}),r}var i=t("lodash._baseeach");e.exports=n},{"lodash._baseeach":31}],31:[function(t,e,r){function n(t,e){return p(t,e,l)}function i(t){return function(e){return null==e?void 0:e[t]}}function o(t,e){return function(r,n){var i=r?d(r):0;if(!a(i))return t(r,n);for(var o=e?i:-1,s=u(r);(e?o--:++o<i)&&n(s[o],o,s)!==!1;);return r}}function s(t){return function(e,r,n){for(var i=u(e),o=n(e),s=o.length,a=t?s:-1;t?a--:++a<s;){var h=o[a];if(r(i[h],h,i)===!1)break}return e}}function a(t){return"number"==typeof t&&t>-1&&t%1==0&&c>=t}function u(t){return h(t)?t:Object(t)}function h(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}var l=t("lodash.keys"),c=9007199254740991,f=o(n),p=s(),d=i("length");e.exports=f},{"lodash.keys":33}],32:[function(t,e,r){function n(t){return"string"==typeof t?t:null==t?"":t+""}function i(t){return!!t&&"object"==typeof t}function o(t,e){var r=null==t?void 0:t[e];return a(r)?r:void 0}function s(t){return"number"==typeof t&&t>-1&&t%1==0&&v>=t}function a(t){return null==t?!1:y.call(t)==l?m.test(g.call(t)):i(t)&&p.test(t)}function u(t){return t=n(t),t&&f.test(t)?t.replace(c,"\\$&"):t}var h="[object Array]",l="[object Function]",c=/[.*+?^${}()|[\]\/\\]/g,f=RegExp(c.source),p=/^\[object .+?Constructor\]$/,d=Object.prototype,g=Function.prototype.toString,b=d.hasOwnProperty,y=d.toString,m=RegExp("^"+u(g.call(b)).replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),w=o(Array,"isArray"),v=9007199254740991,x=w||function(t){return i(t)&&s(t.length)&&y.call(t)==h};e.exports=x},{}],33:[function(t,e,r){function n(t){return function(e){return null==e?void 0:e[t]}}function i(t){return null!=t&&s(m(t))}function o(t,e){return t="number"==typeof t||p.test(t)?+t:-1,e=null==e?y:e,t>-1&&t%1==0&&e>t}function s(t){return"number"==typeof t&&t>-1&&t%1==0&&y>=t}function a(t){for(var e=h(t),r=e.length,n=r&&t.length,i=!!n&&s(n)&&(f(t)||c(t)),a=-1,u=[];++a<r;){var l=e[a];(i&&o(l,n)||g.call(t,l))&&u.push(l)}return u}function u(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function h(t){if(null==t)return[];u(t)||(t=Object(t));var e=t.length;e=e&&s(e)&&(f(t)||c(t))&&e||0;for(var r=t.constructor,n=-1,i="function"==typeof r&&r.prototype===t,a=Array(e),h=e>0;++n<e;)a[n]=n+"";for(var l in t)h&&o(l,e)||"constructor"==l&&(i||!g.call(t,l))||a.push(l);return a}var l=t("lodash._getnative"),c=t("lodash.isarguments"),f=t("lodash.isarray"),p=/^\d+$/,d=Object.prototype,g=d.hasOwnProperty,b=l(Object,"keys"),y=9007199254740991,m=n("length"),w=b?function(t){var e=null==t?null:t.constructor;return"function"==typeof e&&e.prototype===t||"function"!=typeof t&&i(t)?a(t):u(t)?b(t):[]}:a;e.exports=w},{"lodash._getnative":34,"lodash.isarguments":35,"lodash.isarray":32}],34:[function(t,e,r){function n(t){return"string"==typeof t?t:null==t?"":t+""}function i(t){return!!t&&"object"==typeof t}function o(t,e){var r=null==t?void 0:t[e];return s(r)?r:void 0}function s(t){return null==t?!1:g.call(t)==u?b.test(p.call(t)):i(t)&&c.test(t)}function a(t){return t=n(t),t&&l.test(t)?t.replace(h,"\\$&"):t}var u="[object Function]",h=/[.*+?^${}()|[\]\/\\]/g,l=RegExp(h.source),c=/^\[object .+?Constructor\]$/,f=Object.prototype,p=Function.prototype.toString,d=f.hasOwnProperty,g=f.toString,b=RegExp("^"+a(p.call(d)).replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");e.exports=o},{}],35:[function(t,e,r){function n(t){return!!t&&"object"==typeof t}function i(t){return function(e){return null==e?void 0:e[t]}}function o(t){return null!=t&&s(f(t))}function s(t){return"number"==typeof t&&t>-1&&t%1==0&&c>=t}function a(t){return n(t)&&o(t)&&l.call(t)==u}var u="[object Arguments]",h=Object.prototype,l=h.toString,c=9007199254740991,f=i("length");e.exports=a},{}],36:[function(t,e,r){function n(t,e){return function(r,n,o){if(n=i(n,o,3),u(r)){var h=a(r,n,e);return h>-1?r[h]:void 0}return s(r,n,t)}}var i=t("lodash._basecallback"),o=t("lodash._baseeach"),s=t("lodash._basefind"),a=t("lodash._basefindindex"),u=t("lodash.isarray"),h=n(o);e.exports=h},{"lodash._basecallback":37,"lodash._baseeach":42,"lodash._basefind":43,"lodash._basefindindex":44,"lodash.isarray":45}],37:[function(t,e,r){arguments[4][25][0].apply(r,arguments)},{dup:25,"lodash._baseisequal":38,"lodash._bindcallback":40,"lodash.isarray":45,"lodash.pairs":41}],38:[function(t,e,r){arguments[4][26][0].apply(r,arguments)},{dup:26,"lodash.isarray":45,"lodash.istypedarray":39,"lodash.keys":46}],39:[function(t,e,r){arguments[4][27][0].apply(r,arguments)},{dup:27}],40:[function(t,e,r){arguments[4][28][0].apply(r,arguments)},{dup:28}],41:[function(t,e,r){arguments[4][29][0].apply(r,arguments)},{dup:29,"lodash.keys":46}],42:[function(t,e,r){arguments[4][31][0].apply(r,arguments)},{dup:31,"lodash.keys":46}],43:[function(t,e,r){function n(t,e,r,n){var i;return r(t,function(t,r,o){return e(t,r,o)?(i=n?r:t,!1):void 0}),i}e.exports=n},{}],44:[function(t,e,r){function n(t,e,r){for(var n=t.length,i=r?n:-1;r?i--:++i<n;)if(e(t[i],i,t))return i;return-1}e.exports=n},{}],45:[function(t,e,r){arguments[4][32][0].apply(r,arguments)},{dup:32}],46:[function(t,e,r){arguments[4][33][0].apply(r,arguments)},{dup:33,"lodash._getnative":47,"lodash.isarguments":48,"lodash.isarray":45}],47:[function(t,e,r){arguments[4][34][0].apply(r,arguments)},{dup:34}],48:[function(t,e,r){arguments[4][35][0].apply(r,arguments)},{dup:35}],49:[function(t,e,r){function n(t){return!!t&&"object"==typeof t}function i(t){return n(t)&&"string"==typeof t.message&&a.call(t)==o}var o="[object Error]",s=Object.prototype,a=s.toString;e.exports=i},{}],50:[function(t,e,r){function n(t,e){return s(t,e,a)}function i(t){return function(e,r,i){var s={};return r=o(r,i,3),n(e,function(e,n,i){var o=r(e,n,i);n=t?o:n,e=t?e:o,s[n]=e}),s}}var o=t("lodash._basecallback"),s=t("lodash._basefor"),a=t("lodash.keys"),u=i();e.exports=u},{"lodash._basecallback":51,"lodash._basefor":57,"lodash.keys":58}],51:[function(t,e,r){arguments[4][25][0].apply(r,arguments)},{dup:25,"lodash._baseisequal":52,"lodash._bindcallback":54,"lodash.isarray":55,"lodash.pairs":56}],52:[function(t,e,r){arguments[4][26][0].apply(r,arguments)},{dup:26,"lodash.isarray":55,"lodash.istypedarray":53,"lodash.keys":58}],53:[function(t,e,r){arguments[4][27][0].apply(r,arguments)},{dup:27}],54:[function(t,e,r){arguments[4][28][0].apply(r,arguments)},{dup:28}],55:[function(t,e,r){arguments[4][32][0].apply(r,arguments)},{dup:32}],56:[function(t,e,r){arguments[4][29][0].apply(r,arguments)},{dup:29,"lodash.keys":58}],57:[function(t,e,r){function n(t){return function(e,r,n){for(var o=i(e),s=n(e),a=s.length,u=t?a:-1;t?u--:++u<a;){var h=s[u];if(r(o[h],h,o)===!1)break}return e}}function i(t){return o(t)?t:Object(t)}function o(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}var s=n();e.exports=s},{}],58:[function(t,e,r){arguments[4][33][0].apply(r,arguments)},{dup:33,"lodash._getnative":59,"lodash.isarguments":60,"lodash.isarray":61}],59:[function(t,e,r){arguments[4][34][0].apply(r,arguments)},{dup:34}],60:[function(t,e,r){arguments[4][35][0].apply(r,arguments)},{dup:35}],61:[function(t,e,r){arguments[4][32][0].apply(r,arguments)},{dup:32}],62:[function(t,e,r){var n=t("lodash._arraymap"),i=t("lodash._basedifference"),o=t("lodash._baseflatten"),s=t("lodash._bindcallback"),a=t("lodash._pickbyarray"),u=t("lodash._pickbycallback"),h=t("lodash.keysin"),l=t("lodash.restparam"),c=l(function(t,e){if(null==t)return{};if("function"!=typeof e[0]){var e=n(o(e),String);return a(t,i(h(t),e))}var r=s(e[0],e[1],3);return u(t,function(t,e,n){return!r(t,e,n)})});e.exports=c},{"lodash._arraymap":63,"lodash._basedifference":64,"lodash._baseflatten":69,"lodash._bindcallback":72,"lodash._pickbyarray":73,"lodash._pickbycallback":74,"lodash.keysin":76,"lodash.restparam":79}],63:[function(t,e,r){function n(t,e){for(var r=-1,n=t.length,i=Array(n);++r<n;)i[r]=e(t[r],r,t);return i}e.exports=n},{}],64:[function(t,e,r){function n(t,e){var r=t?t.length:0,n=[];if(!r)return n;var a=-1,u=i,h=!0,l=h&&e.length>=200?s(e):null,c=e.length;l&&(u=o,h=!1,e=l);t:for(;++a<r;){var f=t[a];if(h&&f===f){for(var p=c;p--;)if(e[p]===f)continue t;n.push(f)}else u(e,f,0)<0&&n.push(f)}return n}var i=t("lodash._baseindexof"),o=t("lodash._cacheindexof"),s=t("lodash._createcache");e.exports=n},{"lodash._baseindexof":65,"lodash._cacheindexof":66,"lodash._createcache":67}],65:[function(t,e,r){function n(t,e,r){if(e!==e)return i(t,r);for(var n=r-1,o=t.length;++n<o;)if(t[n]===e)return n;return-1}function i(t,e,r){for(var n=t.length,i=e+(r?0:-1);r?i--:++i<n;){var o=t[i];if(o!==o)return i}return-1}e.exports=n},{}],66:[function(t,e,r){function n(t,e){var r=t.data,n="string"==typeof e||i(e)?r.set.has(e):r.hash[e];return n?0:-1}function i(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}e.exports=n},{}],67:[function(t,e,r){(function(r){function n(t){var e=t?t.length:0;for(this.data={hash:h(null),set:new u};e--;)this.push(t[e])}function i(t){var e=this.data;"string"==typeof t||o(t)?e.set.add(t):e.hash[t]=!0}function o(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function s(t){return function(){return t}}var a=t("lodash._getnative"),u=a(r,"Set"),h=a(Object,"create"),l=h&&u?function(t){return new n(t)}:s(null);n.prototype.push=i,e.exports=l}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"lodash._getnative":68}],68:[function(t,e,r){arguments[4][34][0].apply(r,arguments)},{dup:34}],69:[function(t,e,r){function n(t){return!!t&&"object"==typeof t}function i(t,e,r){for(var o=-1,a=t.length,l=-1,c=[];++o<a;){var f=t[o];if(n(f)&&s(f)&&(r||h(f)||u(f))){e&&(f=i(f,e,r));for(var p=-1,d=f.length;++p<d;)c[++l]=f[p]}else r||(c[++l]=f)}return c}function o(t){return function(e){return null==e?void 0:e[t]}}function s(t){return null!=t&&a(c(t))}function a(t){return"number"==typeof t&&t>-1&&t%1==0&&l>=t}var u=t("lodash.isarguments"),h=t("lodash.isarray"),l=9007199254740991,c=o("length");
e.exports=i},{"lodash.isarguments":70,"lodash.isarray":71}],70:[function(t,e,r){arguments[4][35][0].apply(r,arguments)},{dup:35}],71:[function(t,e,r){arguments[4][32][0].apply(r,arguments)},{dup:32}],72:[function(t,e,r){arguments[4][28][0].apply(r,arguments)},{dup:28}],73:[function(t,e,r){function n(t,e){t=i(t);for(var r=-1,n=e.length,o={};++r<n;){var s=e[r];s in t&&(o[s]=t[s])}return o}function i(t){return o(t)?t:Object(t)}function o(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}e.exports=n},{}],74:[function(t,e,r){function n(t,e){return o(t,e,s)}function i(t,e){var r={};return n(t,function(t,n,i){e(t,n,i)&&(r[n]=t)}),r}var o=t("lodash._basefor"),s=t("lodash.keysin");e.exports=i},{"lodash._basefor":75,"lodash.keysin":76}],75:[function(t,e,r){arguments[4][57][0].apply(r,arguments)},{dup:57}],76:[function(t,e,r){function n(t,e){return t="number"==typeof t||h.test(t)?+t:-1,e=null==e?f:e,t>-1&&t%1==0&&e>t}function i(t){return"number"==typeof t&&t>-1&&t%1==0&&f>=t}function o(t){var e=typeof t;return!!t&&("object"==e||"function"==e)}function s(t){if(null==t)return[];o(t)||(t=Object(t));var e=t.length;e=e&&i(e)&&(u(t)||a(t))&&e||0;for(var r=t.constructor,s=-1,h="function"==typeof r&&r.prototype===t,l=Array(e),f=e>0;++s<e;)l[s]=s+"";for(var p in t)f&&n(p,e)||"constructor"==p&&(h||!c.call(t,p))||l.push(p);return l}var a=t("lodash.isarguments"),u=t("lodash.isarray"),h=/^\d+$/,l=Object.prototype,c=l.hasOwnProperty,f=9007199254740991;e.exports=s},{"lodash.isarguments":77,"lodash.isarray":78}],77:[function(t,e,r){arguments[4][35][0].apply(r,arguments)},{dup:35}],78:[function(t,e,r){arguments[4][32][0].apply(r,arguments)},{dup:32}],79:[function(t,e,r){function n(t,e){if("function"!=typeof t)throw new TypeError(i);return e=o(void 0===e?t.length-1:+e||0,0),function(){for(var r=arguments,n=-1,i=o(r.length-e,0),s=Array(i);++n<i;)s[n]=r[e+n];switch(e){case 0:return t.call(this,s);case 1:return t.call(this,r[0],s);case 2:return t.call(this,r[0],r[1],s)}var a=Array(e+1);for(n=-1;++n<e;)a[n]=r[n];return a[e]=s,t.apply(this,a)}}var i="Expected a function",o=Math.max;e.exports=n},{}],80:[function(t,e,r){(function(r){function n(t,e){var r="";if(t=i(t),e=+e,1>e||!t||!s(e))return r;do e%2&&(r+=t),e=o(e/2),t+=t;while(e);return r}var i=t("lodash._basetostring"),o=Math.floor,s=r.isFinite;e.exports=n}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"lodash._basetostring":81}],81:[function(t,e,r){function n(t){return"string"==typeof t?t:null==t?"":t+""}e.exports=n},{}],82:[function(t,e,r){var n;n=t("./svg-coord").get,e.exports=function(t,e){var r,i,o,s,a,u,h,l,c,f,p,d;if(null==t)return{};if(null==e.zero||null==e.places)throw new Error("format undefined");i={},p={},i.x=null!=(o=t.match(/X[+-]?[\d\.]+/))&&null!=(s=o[0])?s.slice(1):void 0,i.y=null!=(a=t.match(/Y[+-]?[\d\.]+/))&&null!=(u=a[0])?u.slice(1):void 0,i.i=null!=(h=t.match(/I[+-]?[\d\.]+/))&&null!=(l=h[0])?l.slice(1):void 0,i.j=null!=(c=t.match(/J[+-]?[\d\.]+/))&&null!=(f=c[0])?f.slice(1):void 0;for(r in i)d=i[r],null!=d&&(p[r]=n(d,e));return p}},{"./svg-coord":95}],83:[function(t,e,r){var n,i,o,s,a,u,h,l,c,f,p,d=function(t,e){function r(){this.constructor=t}for(var n in e)g.call(e,n)&&(t[n]=e[n]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t},g={}.hasOwnProperty;h=t("./parser"),f=t("./coord-parser"),c=t("./svg-coord").get,o={"FMAT,1":"M70","FMAT,2":"M72"},a="M71",n="G90",s="G91",p=/[XY]{1,2}/,l="L",u=[2,4],i=function(t){function e(){this.fmat="FMAT,2",e.__super__.constructor.call(this,arguments[0])}return d(e,t),e.prototype.parseCommand=function(t){var e,r,i,h,d,g,b,y,m,w,v,x;if(g={},";"===t[0])return g;if("FMAT,1"===t)this.fmat=t;else if("M30"===t||"M00"===t)g.set={done:!0};else if(t===o[this.fmat]||t.match(/INCH/))null==(e=this.format).places&&(e.places=[2,4]),g.set={units:"in"};else if(t===a||t.match(/METRIC/))null==(r=this.format).places&&(r.places=[3,3]),g.set={units:"mm"};else if(t===n)g.set={notation:"A"};else if(t===s)g.set={notation:"I"};else if(d=null!=(m=t.match(/T\d+/))?m[0]:void 0){for(;"0"===d[1];)d=d[0]+d.slice(2);(b=null!=(w=t.match(/C[\d\.]+(?=.*$)/))?w[0]:void 0)?(b=b.slice(1),g.tool={},g.tool[d]={dia:c(b,{places:this.format.places})}):g.set={currentTool:d}}if(t.match(/TZ/)?null==(i=this.format).zero&&(i.zero="L"):t.match(/LZ/)&&null==(h=this.format).zero&&(h.zero="T"),t.match(p)){g.op={"do":"flash"},null==this.format.zero&&(console.warn("no drill file zero suppression specified. assuming leading zero suppression (same as no zero suppression)"),this.format.zero=l),null==this.format.places&&(console.warn("no drill file units specified; assuming 2:4 inches format"),this.format.places=u),v=f(t,this.format);for(y in v)x=v[y],g.op[y]=x}return g},e}(h),e.exports=i},{"./coord-parser":82,"./parser":92,"./svg-coord":95}],84:[function(t,e,r){var n;n=function(){function t(t){this.line=0,this.blocks=t.split(/\r?\n/)}return t.prototype.nextBlock=function(){return this.line<this.blocks.length?this.blocks[++this.line-1]:!1},t}(),e.exports=n},{}],85:[function(t,e,r){var n,i,o,s,a,u,h,l,c,f,p,d,g=function(t,e){function r(){this.constructor=t}for(var n in e)b.call(e,n)&&(t[n]=e[n]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t},b={}.hasOwnProperty,y=[].indexOf||function(t){for(var e=0,r=this.length;r>e;e++)if(e in this&&this[e]===t)return e;return-1};a=t("lodash.iserror"),i=t("./parser"),o=t("./warning"),u=t("./coord-parser"),p=t("./svg-coord"),s=p.get,d=p.factor,h=/([XYIJ][+-]?\d+){1,4}/g,f=/(G54)?D0*[1-9]\d+/,l=/G0*[123]/,c=/D0*[123]$/,n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return g(e,t),e.prototype.parseBlock=function(t,e,r){var n,i,o,s,p,d,g,b,y,m,w;if(/^G0*4/.test(t))return r();if("M02"===t)this.push({set:{done:!0},line:e});else if(f.test(t)){if(m=this.parseToolChange(t,e),a(m))return r(m);null!=m&&this.push(m)}else if("G36"===t)this.push({set:{region:!0},line:e});else if("G37"===t)this.push({set:{region:!1},line:e});else if("G70"===t)this.push({set:{backupUnits:"in"},line:e});else if("G71"===t)this.push({set:{backupUnits:"mm"},line:e});else if("G74"===t)this.push({set:{quad:"s"},line:e});else if("G75"===t)this.push({set:{quad:"m"},line:e});else{if(s=t.match(l)){switch(s[0].slice(-1)){case"1":p="i";break;case"2":p="cw";break;case"3":p="ccw"}this.push({set:{mode:p},line:e})}if(o=null!=(b=t.match(h))?b[0]:void 0,(g=t.match(c))||null!=o){d={},i=u(o,this.format);for(n in i)w=i[n],d[n]=w;switch(null!=g&&null!=(y=g[0])?y.slice(-1):void 0){case"1":d["do"]="int";break;case"2":d["do"]="move";break;case"3":d["do"]="flash";break;default:d["do"]="last"}this.push({op:d,line:e})}}return r()},e.prototype.parseParam=function(t,e,r){var n,i,o,s;if(t===!1)return this.macroName&&(i={},i[this.macroName]=this.macroBlocks,this.macroName="",this.push({macro:i})),r();if(n=t.slice(0,2),"FS"===n){if(s=this.parseFormat(t,e),a(s))return r(s);null!=s&&this.push(s)}else if("MO"===n){if(s=this.parseUnits(t,e),a(s))return r(s);null!=s&&this.push(s)}else if("AD"===n){if(s=this.parseToolDef(t,e),a(s))return r(s);null!=s&&this.push(s)}else{if("AM"===n)return this.macroName=t.slice(2),this.macroBlocks=[],r();if(this.macroName)return o=this.parseMacroBlock(t,e),null!=o&&this.macroBlocks.push(o),r();if("LP"===n){if(s=this.parsePolarity(t,e),a(s))return r(s);null!=s&&this.push(s)}else if("SR"===n){if(s=this.parseStepRepeat(t,e),a(s))return r(s);null!=s&&this.push(s)}}return r()},e.prototype.parseFormat=function(t,e){var r,n,i,o,s,a,u;return u="L"===t[2]||"T"===t[2]?t[2]:null,o="A"===t[3]||"I"===t[3]?t[3]:null,"X"===t[4]&&(s=[Number(t[5]),Number(t[6])]),"Y"===t[7]&&(a=[Number(t[8]),Number(t[9])]),null==o?new Error("line "+e+" - notation format must be 'A' or 'I'"):null==u?new Error("line "+e+" - zero suppression format must be 'L' or 'T'"):null==s||null==a||isNaN(s[0])||isNaN(s[1])||s[0]>7||s[1]>7?new Error("line "+e+' - coordinate place format must be "X[0-7][0-7]Y[0-7][0-7]"'):s[0]!==a[0]||s[1]!==a[1]?new Error("line "+e+" - coordinate x and y place formats must match"):(null==(r=this.format).zero&&(r.zero=u),null==(n=this.format).places&&(n.places=s),i=1.5*d*Math.pow(10,-this.format.places[1]),{set:{notation:o,epsilon:i},line:e})},e.prototype.parseUnits=function(t,e){var r,n;if(r=t.slice(2),"IN"===r)n="in";else{if("MM"!==r)return new Error("line "+e+" - "+r+' is an invalid units mode; mode must be "IN" or "MM"');n="mm"}return{set:{units:n},line:e}},e.prototype.parseToolDef=function(t,e){var r,n,i,a,u,h,l,c,f,p,d,g;for(p={},r=null!=(l=t.match(/^ADD\d{2,}/))?l[0].slice(2):void 0,c=t.slice(2+r.length).split(","),f=c[0],h=c[1],h=null!=h?h.split("X"):void 0;"0"===r[1];)r=r[0]+r.slice(2);switch(p[r]={},f){case"C":if(n=s(h[0],{places:this.format.places}),h.length>2){if(a={width:s(h[1],{places:this.format.places}),height:s(h[2],{places:this.format.places})},Math.pow(Math.pow(a.width,2)+Math.pow(a.height,2),.5)>n)return new Error(r+" hole cannot be larger than the shape")}else if(h.length>1&&(a={dia:s(h[1],{places:this.format.places})},a.dia>n))return new Error(r+" hole cannot be larger than the shape");p[r].dia=n,null!=a&&(p[r].hole=a);break;case"R":case"O":if(g=s(h[0],{places:this.format.places}),i=s(h[1],{places:this.format.places}),h.length>3){if(a={width:s(h[2],{places:this.format.places}),height:s(h[3],{places:this.format.places})},a.width>g||a.height>i)return new Error(r+" hole cannot be larger than the shape")}else if(h.length>2&&(a={dia:s(h[2],{places:this.format.places})},a.dia>g||a.dia>i))return new Error(r+" hole cannot be larger than the shape");p[r].width=g,p[r].height=i,"O"===f&&(p[r].obround=!0),null!=a&&(p[r].hole=a);break;case"P":if(d=Number(h[1]),n=s(h[0],{places:this.format.places}),h.length>4){if(a={width:s(h[3],{places:this.format.places}),height:s(h[4],{places:this.format.places})},Math.pow(Math.pow(a.width,2)+Math.pow(a.height,2),.5)>n)return new Error(r+" hole cannot be larger than the shape")}else if(h.length>3&&(a={dia:s(h[3],{places:this.format.places})},a.dia>n*Math.cos(Math.PI/d)))return new Error(r+" hole cannot be larger than the shape");p[r].dia=n,p[r].vertices=d,h.length>2&&(p[r].degrees=Number(h[2])),null!=a&&(p[r].hole=a);break;default:h=function(){var t,e,r,n;for(r=null!=h?h:[],n=[],t=0,e=r.length;e>t;t++)u=r[t],n.push(Number(u));return n}(),p[r].macro=f,p[r].mods=h}return 0>n?new RangeError(r+" diameter cannot be negative"):0>g?new RangeError(r+" width cannot be negative"):0>i?new RangeError(r+" height cannot be negative"):3>d||d>12?new RangeError(r+" polygon vertices must be between 3 and 12"):(null!=a?a.dia:void 0)<0||(null!=a?a.width:void 0)<0||(null!=a?a.height:void 0)<0?new RangeError(r+" hole dimensions cannot be negative"):((0===g||0===i||null!=d&&0===n)&&this.emit("warning",new o(r+" zero-size shapes (except circles) are not technically allowed")),{tool:p,line:e})},e.prototype.parsePolarity=function(t,e){return"D"===t[2]||"C"===t[2]?{"new":{layer:t[2]},line:e}:new Error("line "+e+" - level polarity must be 'D' or 'C'")},e.prototype.parseStepRepeat=function(t,e){var r,n,i,o,a,u,h,l,c,f,p;return f=null!=(i=null!=(o=t.match(/X[+-]?[\d\.]+/))?o[0].slice(1):void 0)?i:1,p=null!=(a=null!=(u=t.match(/Y[+-]?[\d\.]+/))?u[0].slice(1):void 0)?a:1,r=null!=(h=t.match(/I[+-]?[\d\.]+/))?h[0].slice(1):void 0,n=null!=(l=t.match(/J[+-]?[\d\.]+/))?l[0].slice(1):void 0,1>f?new Error("line "+e+" - X must be a positive integer if in SR block"):1>p?new Error("line "+e+" - Y must be a positive integer if in SR block"):0>r||f>1&&null==r?new Error("line "+e+" - I must be a positive number if X is present in SR block"):0>n||p>1&&null==n?new Error("line "+e+" - J must be a positive number if Y is present in SR block"):(c={x:Number(f),y:Number(p)},null!=r&&(c.i=s(r,{places:this.format.places})),null!=n&&(c.j=s(n,{places:this.format.places})),{"new":{sr:c},line:e})},e.prototype.parseToolChange=function(t,e){var r;for(r=t.match(/D\d+/)[0];"0"===r[1];)r=r[0]+r.slice(2);return{set:{currentTool:r},line:e}},e.prototype.parseMacroBlock=function(t,e){var r,n,i,s,a,u,h,l;return y.call(t,"=")>=0?(u=t.split("="),i=u[0],l=u[1],y.call(l,"X")>=0&&(this.emit("warning",new o("line "+e+" - macros should use lowercase 'x' for multiplication")),l=l.replace(/X/g,"x")),{modifier:i,value:l}):(s=t.split(","),r=s[0],n=s[1],"1"!==r&&(h=s[s.length-1]),a=function(){switch(r){case"1":return{shape:"circle",dia:s[2],cx:s[3],cy:s[4]};case"2":case"20":return{shape:"vector",width:s[2],x1:s[3],y1:s[4],x2:s[5],y2:s[6]};case"21":return{shape:"rect",width:s[2],height:s[3],cx:s[4],cy:s[5]};case"22":return{shape:"lowerLeftRect",width:s[2],height:s[3],x:s[4],y:s[5]};case"4":return{shape:"outline",points:s.slice(3,-1)};case"5":return{shape:"polygon",vertices:s[2],cx:s[3],cy:s[4],dia:s[5]};case"6":return{shape:"moire",cx:s[2],cy:s[3],outerDia:s[4],ringThx:s[5],ringGap:s[6],maxRings:s[7],crossThx:s[8],crossLength:s[9]};case"7":return{shape:"thermal",cx:s[2],cy:s[3],outerDia:s[4],innerDia:s[5],gap:s[6]};default:return null}}(),null!=a&&(a.exp=n,null!=h&&(a.rot=h)),a)},e}(i),e.exports=n},{"./coord-parser":82,"./parser":92,"./svg-coord":95,"./warning":97,"lodash.iserror":49}],86:[function(t,e,r){var n;n=function(){function t(t){this.gerberFile=null!=t?t:"",this.line=0,this.charIndex=0,this.end=this.gerberFile.length}return t.prototype.nextBlock=function(){var t,e,r;if(this.index>=this.end)return!1;for(e="",r=!1,0===this.line&&this.line++;!(this.charIndex>=this.end);)if(t=this.gerberFile[this.charIndex++],"%"===t){if(r)return{param:r};r=[]}else if("*"===t){if(!r)return{block:e};r.push(e),e=""}else"\n"===t?this.line++:t>=" "&&"~">=t&&(e+=t);return!1},t.prototype.getLine=function(){return this.line},t}(),e.exports=n},{}],87:[function(t,e,r){(function(r){var n,i,o,s,a,u,h,l;h=t("./obj-to-xml"),u=t("./plotter"),o=t("./drill-reader"),i=t("./drill-parser"),a=t("./gerber-reader"),s=t("./gerber-parser"),l=t("./svg-coord").factor,n={drill:!1,pretty:!1,object:!1,warnArr:null,places:null,zero:null,notation:null,units:null},e.exports=function(t,e){var c,f,p,d,g,b,y,m,w,v,x,_,E,M,k,j,R;null==e&&(e={}),b={};for(d in n)M=n[d],b[d]=M;for(d in e)M=e[d],b[d]=M;if("object"==typeof t){if(null!=t.svg)return h(t,{pretty:b.pretty});throw new Error("non SVG object cannot be converted to an SVG string")}w=null,(null!=b.places||null!=b.zero)&&(w={places:b.places,zero:b.zero}),b.drill?(x=new o(t),m=new i(w)):(x=new a(t),m=new s(w)),v=null,(null!=b.notation||null!=b.units)&&(v={notation:b.notation,units:b.units}),y=new u(x,m,v),g=null,E=null,Array.isArray(b.warnArr)&&(E="undefined"!=typeof window&&null!==window?window:r,null==E.console&&(E.console={}),g=E.console.warn,E.console.warn=function(t){return b.warnArr.push(t.toString())});try{R=y.plot()}catch(A){throw f=A,new Error("Error at line "+y.reader.line+" - "+f.message)}finally{null!=g&&null!=E&&(E.console.warn=g)}y.bbox.xMin>=y.bbox.xMax?(y.bbox.xMin=0,y.bbox.xMax=0,k=0):k=y.bbox.xMax-y.bbox.xMin,y.bbox.yMin>=y.bbox.yMax?(y.bbox.yMin=0,y.bbox.yMax=0,p=0):p=y.bbox.yMax-y.bbox.yMin,j={svg:{xmlns:"http://www.w3.org/2000/svg",version:"1.1","xmlns:xlink":"http://www.w3.org/1999/xlink",width:""+k/l+y.units,height:""+p/l+y.units,viewBox:[y.bbox.xMin,y.bbox.yMin,k,p],_:[]}},_=y.attr;for(c in _)M=_[c],j.svg[c]=M;return y.defs.length&&j.svg._.push({defs:{_:y.defs}}),y.group.g._.length&&j.svg._.push(y.group),b.object?j:h(j,{pretty:b.pretty})}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./drill-parser":83,"./drill-reader":84,"./gerber-parser":85,"./gerber-reader":86,"./obj-to-xml":90,"./plotter":93,"./svg-coord":95}],88:[function(t,e,r){var n,i,o,s,a,u;i=/[\+\-\/xX\(\)]/,n=/[\$\d\.]+/,o=new RegExp("("+i.source+")|("+n.source+")","g"),u=function(t){var e;return e=t.match(o)},s=function(t){return n.test(t)},a=function(t){var e,r,n,i,o,a,h;return h=u(t),r=0,a=function(){return h[r]},e=function(t){return r++},o=function(){var r,i;if(i=a(),e(i),s(i))r={type:"n",val:i};else{if("("!==i)throw new Error(t+" is a poorly formatted expression");if(r=n(),")"!==a())throw new Error("unmatched parentheses while parsing a macro expression");e(")")}return r},i=function(){var t,r,n;for(t=o(),n=a();"x"===n||"/"===n;)e(n),r=o(),t={type:n,left:t,right:r},n=a();return t},(n=function(){var t,r,n;for(t=i(),n=a();"+"===n||"-"===n;)e(n),r=i(),t={type:n,left:t,right:r},n=a();return t})()},e.exports={tokenize:u,isNumber:s,parse:a}},{}],89:[function(t,e,r){var n,i,o,s,a,u,h,l,c,f,p,d=function(t,e){function r(){this.constructor=t}for(var n in e)g.call(e,n)&&(t[n]=e[n]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t},g={}.hasOwnProperty;n=t("events").EventEmitter,l=t("lodash.mapvalues"),u=t("lodash.find"),a=t("lodash.filter"),c=t("lodash.omit"),f=t("./pad-shapes"),s=t("./macro-calc"),p=t("./unique-id"),h=t("./svg-coord").get,o=t("./warning"),i=function(t){function e(t,e){this.blocks=null!=t?t:[],this.modifiers={},this.shapes=[],this.masks=[],this.lastExposure=null,this.bbox=[1/0,1/0,-(1/0),-(1/0)],this.format={places:e}}return d(e,t),e.prototype.run=function(t,e){var r,n,i,o,s,a,u,h,l,c,f,d,g,b;for(null==e&&(e=[]),this.lastExposure=null,this.shapes=[],this.masks=[],this.bbox=[1/0,1/0,-(1/0),-(1/0)],this.modifiers={},n=i=0,a=e.length;a>i;n=++i)l=e[n],this.modifiers["$"+(n+1)]=l;for(d=this.blocks,o=0,u=d.length;u>o;o++)r=d[o],null!=r.shape?this.primitive(r):this.modifiers[r.modifier]=this.getNumber(r.value);for(1===this.shapes.length?c=this.shapes:this.shapes.length>1&&(c=[{g:{_:this.shapes}}]),f="tool-"+t+"-pad-"+p(),null!=c&&(b=Object.keys(c[0])[0],c[0][b].id=f),g=this.masks,s=0,h=g.length;h>s;s++)l=g[s],c.unshift(l);return{pad:null!=c?c:[],padId:f,bbox:this.bbox,trace:!1}},e.prototype.primitive=function(t){var e,r,n,i,s,d,g,b,y,m,w,v,x,_,E,M,k,j,R,A,L,S,T,B,I,O;switch(v=!1,L=!1,B=t.shape,v=null!=t.exp?0===this.getNumber(t.exp):void 0,O=null!=t.vertices?this.getNumber(t.vertices,this.format):void 0,L=null!=t.rot?this.getNumber(t.rot):void 0,_=null!=t.maxRings?this.getNumber(t.maxRings):void 0,t=l(c(t,["shape","exp","rot","maxRings"]),function(t){return function(e){var r,n,i,o;if(Array.isArray(e)){for(e=t.getNumber(e),i=[],r=0,n=e.length;n>r;r++)o=e[r],i.push(h(o,t.format));return i}return h(t.getNumber(e),t.format)}}(this)),B){case"circle":T=f.circle({dia:t.dia,cx:t.cx,cy:t.cy});break;case"vector":T=f.vector({width:t.width,x1:t.x1,y1:t.y1,x2:t.x2,y2:t.y2}),L&&(T.shape.line.transform="rotate("+L+")");break;case"rect":T=f.rect({width:t.width,height:t.height,cx:t.cx,cy:t.cy}),L&&(T.shape.rect.transform="rotate("+L+")");break;case"lowerLeftRect":T=f.lowerLeftRect({width:t.width,height:t.height,x:t.x,y:t.y}),L&&(T.shape.rect.transform="rotate("+L+")");break;case"outline":T=f.outline({points:t.points}),L&&(T.shape.polygon.transform="rotate("+L+")");break;case"polygon":!L||0===t.cx&&0===t.cy||(this.emit("warning",new o("a macro polygon can only be rotated if its center is at 0, 0")),L=0),T=f.polygon({vertices:O,cx:t.cx,cy:t.cy,dia:t.dia,degrees:L}),L=0;break;case"moire":if(T=f.moire({cx:t.cx,cy:t.cy,outerDia:t.outerDia,ringThx:t.ringThx,ringGap:t.ringGap,maxRings:_,crossThx:t.crossThx,crossLength:t.crossLength}),L)if(0!==t.cx||0!==t.cy)this.emit("warning",new o("a macro moiré can only be rotated if its center is at 0, 0")),L=0;else for(m=a(T.shape,"line"),r=0,d=m.length;d>r;r++)M=m[r],M.line.transform="rotate("+L+")";break;case"thermal":if(T=f.thermal({cx:t.cx,cy:t.cy,outerDia:t.outerDia,innerDia:t.innerDia,gap:t.gap}),L)if(0!==t.cx||0!==t.cy)this.emit("warning",new o("a macro thermal can only be rotated if its center is at 0, 0")),L=0;else for(I=u(T.shape,"mask"),k=a(I.mask._,"rect"),n=0,g=k.length;g>n;n++)M=k[n],M.rect.transform="rotate("+L+")"}if(v){for(i in T.shape)T.shape[i].fill="#000";if(0!==this.lastExposure){if(this.lastExposure=0,x="macro-"+this.name+"-mask-"+p(),w={mask:{id:x}},w.mask._=[{rect:{x:this.bbox[0],y:this.bbox[1],width:this.bbox[2]-this.bbox[0],height:this.bbox[3]-this.bbox[1],fill:"#fff"}}],1===this.shapes.length)for(i in this.shapes[0])this.shapes[0][i].mask="url(#"+x+")";else{if(!(this.shapes.length>1))return;for(e={mask:"url(#"+x+")",_:[]},j=this.shapes,s=0,b=j.length;b>s;s++)S=j[s],e._.push(S);this.shapes=[{g:e}]}this.masks.push(w)}return this.masks[this.masks.length-1].mask._.push(T.shape)}if(this.addBbox(T.bbox,L),this.lastExposure=1,Array.isArray(T.shape)){for(R=T.shape,A=[],E=0,y=R.length;y>E;E++)S=R[E],null!=S.mask?A.push(this.masks.push(S)):A.push(this.shapes.push(S));return A}return this.shapes.push(T.shape)},e.prototype.addBbox=function(t,e){var r,n,i,o,s,a,u,h,l;if(null==e&&(e=0),e){for(u=Math.sin(e*Math.PI/180),n=Math.cos(e*Math.PI/180),Math.abs(u)<1e-9&&(u=0),Math.abs(n)<1e-9&&(n=0),a=[[t[0],t[1]],[t[2],t[1]],[t[2],t[3]],[t[0],t[3]]],i=0,o=a.length;o>i;i++)s=a[i],h=s[0]*n-s[1]*u,l=s[0]*u+s[1]*n,h<this.bbox[0]&&(this.bbox[0]=h),l<this.bbox[1]&&(this.bbox[1]=l),h>this.bbox[2]&&(this.bbox[2]=h),l>this.bbox[3]&&(this.bbox[3]=l);return this.bbox=function(){var t,e,n,i;for(n=this.bbox,i=[],t=0,e=n.length;e>t;t++)r=n[t],i.push(r===-0?0:r);return i}.call(this)}return t[0]<this.bbox[0]&&(this.bbox[0]=t[0]),t[1]<this.bbox[1]&&(this.bbox[1]=t[1]),t[2]>this.bbox[2]&&(this.bbox[2]=t[2]),t[3]>this.bbox[3]?this.bbox[3]=t[3]:void 0},e.prototype.getNumber=function(t){var e,r,n,i,o;if(Array.isArray(t)){for(o=[],r=0,n=t.length;n>r;r++)e=t[r],o.push(this.getNumber(e));return o}return t.match(/^[+-]?[\d.]+$/)?Number(t):t.match(/^\$\d+$/)?null!=(i=this.modifiers[t])?i:0:this.evaluate(s.parse(t))},e.prototype.evaluate=function(t){switch(t.type){case"n":return this.getNumber(t.val);case"+":return this.evaluate(t.left)+this.evaluate(t.right);case"-":return this.evaluate(t.left)-this.evaluate(t.right);case"x":return this.evaluate(t.left)*this.evaluate(t.right);case"/":return this.evaluate(t.left)/this.evaluate(t.right)}},e}(n),e.exports=i},{"./macro-calc":88,"./pad-shapes":91,"./svg-coord":95,"./unique-id":96,"./warning":97,events:6,"lodash.filter":23,"lodash.find":36,"lodash.mapvalues":50,"lodash.omit":62}],90:[function(t,e,r){var n,i,o,s;s=t("lodash.repeat"),n="_",i="  ",o=function(t,e){var r,a,u,h,l,c,f,p,d,g,b,y,m,w,v,x,_,E,M;if(null==e&&(e={}),y=e.pretty,c=null!=(m=e.indent)?m:0,a=null!=(w=e.maxDec)?w:!1,u=function(t){return"number"==typeof t?Number(t.toFixed(a)):t},g=y?"\n":"",x=g?"string"==typeof y?y:i:"",x=s(x,c),M="","function"==typeof t&&(t=t()),Array.isArray(t))for(l=f=0,d=t.length;d>f;l=++f)b=t[l],M+=(0!==l?g:"")+o(b,e);else if("object"==typeof t){if(r=!1,h=Object.keys(t)[0],null!=h){M=x+"<"+h,"function"==typeof t[h]&&(t[h]=t[h]()),v=t[h];for(p in v)E=v[p],"function"==typeof E&&(E=E()),p===n?r=E:(Array.isArray(E)&&(a&&(E=function(){var t,e,r;for(r=[],t=0,e=E.length;e>t;t++)_=E[t],r.push(u(_));return r}()),E=E.join(" ")),a&&(E=u(E)),M+=" "+p+'="'+E+'"');r&&(M+=">"+g+o(r,{pretty:y,indent:c+1})),M+=null!=t[h]._?""+g+x+"</"+h+">":"/>"}}else M+=t+" ";return M},e.exports=o},{"lodash.repeat":80}],91:[function(t,e,r){var n,i,o,s,a,u,h,l,c;l=t("./unique-id"),n=function(t){var e;if(null==t.dia)throw new Error("circle function requires diameter");if(null==t.cx)throw new Error("circle function requires x center");if(null==t.cy)throw new Error("circle function requires y center");return e=t.dia/2,{shape:{circle:{cx:t.cx,cy:t.cy,r:e}},bbox:[t.cx-e,t.cy-e,t.cx+e,t.cy+e]}},u=function(t){var e,r,n,i;if(null==t.width)throw new Error("rectangle requires width");if(null==t.height)throw new Error("rectangle requires height");if(null==t.cx)throw new Error("rectangle function requires x center");if(null==t.cy)throw new Error("rectangle function requires y center");return n=t.cx-t.width/2,i=t.cy-t.height/2,r={shape:{rect:{x:n,y:i,width:t.width,height:t.height}},bbox:[n,i,n+t.width,i+t.height]},t.obround&&(e=.5*Math.min(t.width,t.height),r.shape.rect.rx=e,r.shape.rect.ry=e),r},a=function(t){var e,r,n,i,o,s,a,u,h,l,c,f,p,d,g,b;if(null==t.dia)throw new Error("polygon requires diameter");if(null==t.vertices)throw new Error("polygon requires vertices");if(null==t.cx)throw new Error("polygon function requires x center");if(null==t.cy)throw new Error("polygon function requires y center");for(u=null!=t.degrees?t.degrees*Math.PI/180:0,h=2*Math.PI/t.vertices,i=t.dia/2,n="",p=null,b=null,f=null,g=null,e=r=0,o=t.vertices;o>=0?o>r:r>o;e=o>=0?++r:--r)l=u+e*h,s=i*Math.cos(l),a=i*Math.sin(l),Math.abs(s)<1e-9&&(s=0),Math.abs(a)<1e-9&&(a=0),c=t.cx+s,d=t.cy+a,(p>c||null===p)&&(p=c),(c>f||null===f)&&(f=c),(b>d||null===b)&&(b=d),(d>g||null===g)&&(g=d),n+=" "+c+","+d;return{shape:{polygon:{points:n.slice(1)}},bbox:[p,b,f,g]}},c=function(t){var e,r,n;if(null==t.x1)throw new Error("vector function requires start x");if(null==t.y1)throw new Error("vector function requires start y");if(null==t.x2)throw new Error("vector function requires end x");if(null==t.y2)throw new Error("vector function requires end y");if(null==t.width)throw new Error("vector function requires width");return e=Math.abs(Math.atan((t.y2-t.y1)/(t.x2-t.x1))),r=t.width/2*Math.sin(e),n=t.width/2*Math.cos(e),1e-7>r&&(r=0),1e-7>n&&(n=0),{shape:{line:{x1:t.x1,x2:t.x2,y1:t.y1,y2:t.y2,"stroke-width":t.width,"stroke-linecap":"butt"}},bbox:[Math.min(t.x1,t.x2)-r,Math.min(t.y1,t.y2)-n,Math.max(t.x1,t.x2)+r,Math.max(t.y1,t.y2)+n]}},i=function(t){if(null==t.width)throw new Error("lower left rect requires width");if(null==t.height)throw new Error("lower left rect requires height");if(null==t.x)throw new Error("lower left rectangle requires x");if(null==t.y)throw new Error("lower left rectangle requires y");return{shape:{rect:{x:t.x,y:t.y,width:t.width,height:t.height}},bbox:[t.x,t.y,t.x+t.width,t.y+t.height]}},s=function(t){var e,r,n,i,o,s,a,u,h,l,c,f,p,d;if(!Array.isArray(t.points))throw new Error("outline function requires points array");if(!(t.points.length>=4))throw new Error("outline function requires more than one point");if(t.points.length%2!==0)throw new Error("outline function points array length must be even");for(l=null,d=null,h=null,p=null,o="",s=t.points,e=r=0,n=s.length;n>r;e=r+=2)i=s[e],a=i,c=t.points[e+1],(l>a||null===l)&&(l=a),(a>h||null===h)&&(h=a),(d>c||null===d)&&(d=c),(c>p||null===p)&&(p=c),o+=" "+a+","+c;if(u=t.points[t.points.length-2],f=t.points[t.points.length-1],u!==t.points[0]||f!==t.points[1])throw new RangeError("last point must match first point of outline");return{shape:{polygon:{points:o.slice(1)}},bbox:[l,d,h,p]}},o=function(t){var e,r,n;if(null==t.cx)throw new Error("moiré requires x center");if(null==t.cy)throw new Error("moiré requires y center");if(null==t.outerDia)throw new Error("moiré requires outer diameter");if(null==t.ringThx)throw new Error("moiré requires ring thickness");if(null==t.ringGap)throw new Error("moiré requires ring gap");if(null==t.maxRings)throw new Error("moiré requires max rings");if(null==t.crossLength)throw new Error("moiré requires crosshair length");if(null==t.crossThx)throw new Error("moiré requires crosshair thickness");for(n=[{line:{x1:t.cx-t.crossLength/2,y1:0,x2:t.cx+t.crossLength/2,y2:0,"stroke-width":t.crossThx,"stroke-linecap":"butt"}},{line:{x1:0,y1:t.cy-t.crossLength/2,x2:0,y2:t.cy+t.crossLength/2,"stroke-width":t.crossThx,"stroke-linecap":"butt"}}],e=(t.outerDia-t.ringThx)/2,r=0;e>=t.ringThx&&r<t.maxRings;)n.push({circle:{cx:t.cx,cy:t.cy,r:e,fill:"none","stroke-width":t.ringThx}}),r++,e-=t.ringThx+t.ringGap;return e+=.5*t.ringThx,e>0&&r<t.maxRings&&n.push({circle:{cx:t.cx,cy:t.cy,r:e}}),{shape:n,bbox:[Math.min(t.cx-t.crossLength/2,t.cx-t.outerDia/2),Math.min(t.cy-t.crossLength/2,t.cy-t.outerDia/2),Math.max(t.cx+t.crossLength/2,t.cx+t.outerDia/2),Math.max(t.cy+t.crossLength/2,t.cy+t.outerDia/2)]}},h=function(t){var e,r,n,i,o,s,a,u,h;if(null==t.cx)throw new Error("thermal requires x center");if(null==t.cy)throw new Error("thermal requires y center");if(null==t.outerDia)throw new Error("thermal requires outer diameter");if(null==t.innerDia)throw new Error("thermal requires inner diameter");if(null==t.gap)throw new Error("thermal requires gap");return r="thermal-mask-"+l(),o=(t.outerDia-t.innerDia)/2,n=t.outerDia/2,i=n-o/2,a=t.cx-n,s=t.cx+n,h=t.cy-n,u=t.cy+n,e=t.gap/2,{shape:[{mask:{id:r,_:[{circle:{cx:t.cx,cy:t.cy,r:n,fill:"#fff"}},{rect:{x:a,y:-e,width:t.outerDia,height:t.gap,fill:"#000"}},{rect:{x:-e,y:h,width:t.gap,height:t.outerDia,fill:"#000"}}]}},{circle:{cx:t.cx,cy:t.cy,r:i,fill:"none","stroke-width":o,mask:"url(#"+r+")"}}],bbox:[a,h,s,u]}},e.exports={circle:n,rect:u,polygon:a,vector:c,lowerLeftRect:i,outline:s,moire:o,thermal:h}},{"./unique-id":96}],92:[function(t,e,r){var n,i,o=function(t,e){function r(){this.constructor=t}for(var n in e)s.call(e,n)&&(t[n]=e[n]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t},s={}.hasOwnProperty;i=t("stream").Transform,n=function(t){function e(t){var r,n;if(null==t&&(t={}),this.format={zero:null!=(r=t.zero)?r:null,places:null!=(n=t.places)?n:null},null!=this.format.places&&(2!==this.format.places.length||"number"!=typeof this.format.places[0]||"number"!=typeof this.format.places[1]))throw new Error("parser places format must be an array of two numbers");if(null!=this.format.zero&&"L"!==this.format.zero&&"T"!==this.format.zero)throw new Error("parser zero format must be either 'L' or 'T'");e.__super__.constructor.call(this,{readableObjectMode:!0,writableObjectMode:!0})}return o(e,t),e.prototype._transform=function(t,e,r){return null!=t.block?this.parseBlock(t.block,t.line,r):null!=t.param?this.parseParam(t.param,t.line,r):r()},e}(i),e.exports=n},{stream:21}],93:[function(t,e,r){var n,i,o,s,a,u,h,l,c,f,p,d,g=function(t,e){function r(){this.constructor=t}for(var n in e)b.call(e,n)&&(t[n]=e[n]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t},b={}.hasOwnProperty;h=t("stream").Transform,l=t("./warning"),d=t("./unique-id"),o=t("./macro-tool"),p=t("./standard-tool"),f=t("./svg-coord").factor,i=Math.PI/2,a=3*i,u=2*Math.PI,n="in",c=function(t,e){return t.xMin<e.xMin&&(e.xMin=t.xMin),t.yMin<e.yMin&&(e.yMin=t.yMin),t.xMax>e.xMax&&(e.xMax=t.xMax),t.yMax>e.yMax?e.yMax=t.yMax:void 0},s=function(t){function e(t){null==t&&(t={}),this.units=t.units,this.notation=t.notation,this.tools={},this.macros={},this.stepRepeat={x:1,y:1,i:0,j:0},this.x=0,this.y=0,this.firstOperation=!0,this.polarity="D",this.defs=[],this.current=[],this.layerBbox={xMin:1/0,yMin:1/0,xMax:-(1/0),yMax:-(1/0)},this.stepRepeat={x:1,y:1,i:0,j:0},this.srOverClear=!1,this.srOverCurrent=[],this.path=[],this.group={g:{_:[]}},this.bbox={xMin:1/0,yMin:1/0,xMax:-(1/0),yMax:-(1/0)},e.__super__.constructor.call(this,{objectMode:!0})}return g(e,t),e.prototype._transform=function(t,e,r){return null!=t.set?this.handleSet(t.set,t.line,r):null!=t["new"]?this.handleNew(t["new"],t.line,r):null!=t.tool?this.handleTool(t.tool,t.line,r):null!=t.macro?this.handleMacro(t.macro,t.line,r):null!=t.op?this.handleOperation(t.op,t.line,r):r()},e.prototype._flush=function(t){var e,r,n,i;return this.finish(),this.group.g._.length?e=[{defs:{_:this.defs}},this.group]:this.bbox={xMin:0,yMin:0,xMax:0,yMax:0},n=this.bbox.xMax-this.bbox.xMin,r=this.bbox.yMax-this.bbox.yMin,i={svg:{xmlns:"http://www.w3.org/2000/svg",version:"1.1","xmlns:xlink":"http://www.w3.org/1999/xlink",width:""+n/f+this.units,height:""+r/f+this.units,viewBox:[this.bbox.xMin,this.bbox.yMin,n,r],"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":0,stroke:"#000",_:null!=e?e:[]}},this.push(i),t()},e.prototype.handleSet=function(t,e,r){var n,i;for(n in t)if(i=t[n],"currentTool"===n){if(null==this.tools[i]&&this.emit("warning",new l("tool "+i+" is undefined",e)),this.region)return r(new Error("line "+e+" - cannot change tool while region mode is on"));this.changeTool(i)}else"units"===n||"backupUnits"===n||"notation"===n?null==this[n]&&(this[n]=i):("region"===n&&this.finishPath(),this[n]=i);return r()},e.prototype.handleNew=function(t,e,r){if(this.finishLayer(),null!=t.sr)this.finishSR(),this.stepRepeat=t.sr;else{if(null==t.layer)throw new Error(t+" is a poorly formatted or unknown new command");
this.polarity=t.layer}return r()},e.prototype.handleTool=function(t,e,r){var n,i,o,s,a;return n=Object.keys(t)[0],s=t[n],null!=this.tools[n]?r(new Error("line "+e+" - tool "+n+" was previously defined")):(null!=s.macro?(o=this.macros[s.macro],i=function(t){return function(r){return r.message="warning from macro "+s.macro+" run at line "+e+" - "+r.message,t.emit("warning",r)}}(this),o.on("warning",i),a=o.run(n,s.mods),o.removeListener("warning",i)):a=p(n,s),this.tools[n]={code:n,trace:a.trace,pad:a.pad,flash:function(t,e){return{use:{x:t,y:e,"xlink:href":"#"+a.padId}}},flashed:!1,bbox:function(t,e){return null==t&&(t=0),null==e&&(e=0),{xMin:t+a.bbox[0],yMin:e+a.bbox[1],xMax:t+a.bbox[2],yMax:e+a.bbox[3]}}},this.changeTool(n),r())},e.prototype.handleMacro=function(t,e,r){var n,i,s;return s=Object.keys(t)[0],n=t[s],i=new o(n),this.macros[s]=i,r()},e.prototype.changeTool=function(t){return this.finishPath(),this.currentTool=this.tools[t]},e.prototype.prepareForFirstOperation=function(t){var e;return this.firstOperation=!1,null==this.units&&(e="line "+t+" - ",null!=this.backupUnits?(this.units=this.backupUnits,e+="units set to "+this.units+" by deprecated G70/1"):(this.units=n,e+="no units set before first move; assuming "+n),this.emit("warning",new l(e))),null==this.notation?(this.notation="A",e="line "+t+" - no coordinate notation set before first move; assuming absolute",this.emit("warning",new l(e))):void 0},e.prototype.handleOperation=function(t,e,r){var n,i,o,s,a,u,h,f,p,d;if(this.firstOperation&&this.prepareForFirstOperation(e),f=this.x,p=this.y,"I"===this.notation&&(t.x=(null!=(o=t.x)?o:0)+this.x,t.y=(null!=(s=t.y)?s:0)+this.y),this.x=null!=(a=t.x)?a:this.x,this.y=null!=(u=t.y)?u:this.y,"last"===t["do"]?(this.emit("warning",new l("line "+e+" - modal operation codes are deprecated and not guarenteed to render properly")),t["do"]=this.lastOperation):this.lastOperation=t["do"],"flash"===t["do"]){if(this.region)return r(new Error("line "+e+" - cannot flash while in region mode"));if(this.finishPath(),!this.currentTool.flashed){for(h=this.currentTool.pad,n=0,i=h.length;i>n;n++)d=h[n],this.defs.push(d);this.currentTool.flashed=!0}this.current.push(this.currentTool.flash(this.x,this.y)),c(this.currentTool.bbox(this.x,this.y),this.layerBbox)}else if("int"===t["do"]){if(!this.region&&!this.currentTool.trace)return r(new Error("line "+e+" - "+this.currentTool.code+" is not a strokable tool"));if(null==this.mode&&(this.mode="i",this.emit("warning",new l("line "+e+" - interpolation mode was not set before first stroke; assuming linear"))),this.path.length||this.path.push("M",f,p),"i"===this.mode)this.drawLine(f,p,e);else{if(!this.region&&null==this.currentTool.trace["stroke-width"])return r(new Error("line "+e+" - cannot stroke an arc with non-circular tool "+this.currentTool.code));if(null==this.quad)return r(new Error("line "+e+" - quadrant mode was not set before first arc draw"));this.drawArc(f,p,t.i,t.j,e)}}else this.path.length&&this.path.push("M",this.x,this.y);return r()},e.prototype.drawLine=function(t,e,r){var n,o,s,a,u,h,l,f,p,d,g,b,y;if(this.region?(f={xMin:t,yMin:e,xMax:t,yMax:e},n={xMin:this.x,yMin:this.y,xMax:this.x,yMax:this.y}):(f=this.currentTool.bbox(t,e),n=this.currentTool.bbox(this.x,this.y)),c(f,this.layerBbox),c(n,this.layerBbox),this.region||null!=this.currentTool.trace["stroke-width"])return this.path.push("L",this.x,this.y);if(l=this.currentTool.pad[0].rect.width/2,h=this.currentTool.pad[0].rect.height/2,p=t-l,d=t+l,g=e-h,b=e+h,o=this.x-l,s=this.x+l,a=this.y-h,u=this.y+h,y=Math.atan2(this.y-e,this.x-t),y>=0&&i>y)return this.path.push("M",p,g,d,g,s,a,s,u,o,u,p,b,"Z");if(y>=i&&y<=Math.PI)return this.path.push("M",p,g,d,g,d,b,s,u,o,u,o,a,"Z");if(-Math.PI<=y&&-i>y)return this.path.push("M",d,g,d,b,p,b,o,u,o,a,s,a,"Z");if(y>=-i&&0>y)return this.path.push("M",p,g,o,a,s,a,s,u,d,b,p,b,"Z");throw new Error("rectangular stroke angle calculation yielded: "+y)},e.prototype.drawArc=function(t,e,r,n,o){var s,h,f,p,d,g,b,y,m,w,v,x,_,E,M,k,j,R,A,L,S,T,B,I,O,U,P,D;for(null==r&&(r=0),null==n&&(n=0),w=Math.sqrt(Math.pow(r,2)+Math.pow(n,2)),_="cw"===this.mode?0:1,b=0,j=[],f=[[t+r,e+n]],"s"===this.quad&&f.push([t-r,e-n],[t-r,e+n],[t+r,e-n]),d=0,y=f.length;y>d;d++)s=f[d],p=Math.sqrt(Math.pow(s[0]-this.x,2)+Math.pow(s[1]-this.y,2)),Math.abs(w-p)<this.epsilon&&j.push({x:s[0],y:s[1]});for(M=0,k=0,h=null,g=0,m=j.length;m>g&&(s=j[g],M=Math.atan2(this.y-s.y,this.x-s.x),0>M&&(M+=u),k=Math.atan2(e-s.y,t-s.x),0>k&&(k+=u),"cw"===this.mode&&M>k?k+=u:"ccw"===this.mode&&k>M&&(M+=u),E=Math.abs(M-k),"s"===this.quad&&i>=E?h=s:"m"===this.quad&&(E>=Math.PI&&(b=1),h={x:s.x,y:s.y}),null==h);g++);return null==h?void this.emit("warning",new l("line "+o+" - "+this.mode+" arc from ("+t+", "+e+") to ("+this.x+", "+this.y+") with center offset ("+r+", "+n+") is an impossible arc in "+("s"===this.quad?"single":"multi")+" quadrant mode with epsilon set to "+this.epsilon)):(v=this.region?0:this.currentTool.bbox().xMax,"cw"===this.mode&&(x=[k,M],M=x[0],k=x[1]),T=k>0?u:0,P=i+(k>i?u:0),S=Math.PI+(k>Math.PI?u:0),U=a+(k>a?u:0),L=S>=k&&M>=S?h.x-w-v:Math.min(t,this.x)-v,A=T>=k&&M>=T?h.x+w+v:Math.max(t,this.x)+v,O=U>=k&&M>=U?h.y-w-v:Math.min(e,this.y)-v,I=P>=k&&M>=P?h.y+w+v:Math.max(e,this.y)+v,R=Math.abs(t-this.x),B=Math.abs(e-this.y),D=R<this.epsilon&&B<this.epsilon,"m"===this.quad&&D&&(this.path.push("A",w,w,0,0,_,this.x+2*r,this.y+2*n),L=h.x-w-v,O=h.y-w-v,A=h.x+w+v,I=h.y+w+v),this.path.push("A",w,w,0,b,_,this.x,this.y),"s"===this.quad&&D&&this.path.push("Z"),c({xMin:L,yMin:O,xMax:A,yMax:I},this.layerBbox))},e.prototype.finishPath=function(){var t,e,r,n;if(this.path.length){if(e={path:{d:this.path}},this.region)this.path.push("Z");else{r=this.currentTool.trace;for(t in r)n=r[t],e.path[t]=n}return this.current.push(e),this.path=[]}},e.prototype.finishLayer=function(){var t,e,r,n,i,o,s,a,u,h,l,f,p,g,b,y;if(this.finishPath(),this.current.length){if(this.stepRepeat.x>1||this.stepRepeat.y>1){for(f="gerber-sr_"+d(),this.current=[{g:{id:f,_:this.current}}],(this.srOverClear||this.stepRepeat.i<this.layerBbox.xMax-this.layerBbox.xMin||this.stepRepeat.j<this.layerBbox.yMax-this.layerBbox.yMin)&&(a={},a[this.polarity]=f,this.srOverCurrent.push(a),"C"===this.polarity&&(this.srOverClear=!0,this.defs.push(this.current[0]))),b=n=0,u=this.stepRepeat.x;u>=0?u>n:n>u;b=u>=0?++n:--n)for(y=i=0,h=this.stepRepeat.y;h>=0?h>i:i>h;y=h>=0?++i:--i)(0!==b||0!==y)&&(p={use:{"xlink:href":"#"+f}},0!==b&&(p.use.x=b*this.stepRepeat.i),0!==y&&(p.use.y=y*this.stepRepeat.j),this.current.push(p));this.layerBbox.xMax+=(this.stepRepeat.x-1)*this.stepRepeat.i,this.layerBbox.yMax+=(this.stepRepeat.y-1)*this.stepRepeat.j}if(c(this.layerBbox,this.bbox),this.layerBbox={xMin:1/0,yMin:1/0,xMax:-(1/0),yMax:-(1/0)},"D"===this.polarity)if(null!=this.group.g.mask&&this.current.unshift(this.group),null==this.group.g.mask&&this.group.g._.length)for(l=this.current,s=0,o=l.length;o>s;s++)t=l[s],this.group.g._.push(t);else this.group={g:{_:this.current}};else"C"!==this.polarity||this.srOverClear||(r="gerber-mask_"+d(),g=this.bbox.xMax-this.bbox.xMin,e=this.bbox.yMax-this.bbox.yMin,this.current.unshift({rect:{x:this.bbox.xMin,y:this.bbox.yMin,width:g,height:e,fill:"#fff"}}),this.defs.push({mask:{id:r,color:"#000",_:this.current}}),this.group.g.mask="url(#"+r+")");return this.current=[]}},e.prototype.finishSR=function(){var t,e,r,n,i,o,s,a,u,h,l,c,f,p,g,b;if(this.srOverClear&&this.srOverCurrent){for(o="gerber-sr-mask_"+d(),i={mask:{color:"#000",id:o,_:[]}},i.mask._.push({rect:{fill:"#fff",x:this.bbox.xMin,y:this.bbox.yMin,width:this.bbox.xMax-this.bbox.xMin,height:this.bbox.yMax-this.bbox.yMin}}),g=t=0,a=this.stepRepeat.x*this.stepRepeat.i,u=this.stepRepeat.i;u>0?a>t:t>a;g=t+=u)for(b=e=0,h=this.stepRepeat.y*this.stepRepeat.j,l=this.stepRepeat.j;l>0?h>e:e>h;b=e+=l)for(c=this.srOverCurrent,s=0,n=c.length;n>s;s++)r=c[s],p={use:{}},0!==g&&(p.use.x=g),0!==b&&(p.use.y=b),p.use["xlink:href"]="#"+(null!=(f=r.C)?f:r.D),null!=r.D&&(p.use.fill="#fff"),i.mask._.push(p);return this.srOverClear=!1,this.srOverCurrent=[],this.defs.push(i),this.group.g.mask="url(#"+o+")"}},e.prototype.finish=function(){return this.finishLayer(),this.finishSR(),this.group.g.fill="currentColor",this.group.g.stroke="currentColor",this.group.g.transform="translate(0,"+(this.bbox.yMin+this.bbox.yMax)+") scale(1,-1)"},e}(h),e.exports=s},{"./macro-tool":89,"./standard-tool":94,"./svg-coord":95,"./unique-id":96,"./warning":97,stream:21}],94:[function(t,e,r){var n,i,o;o=t("./unique-id"),n=t("./pad-shapes"),i=function(t,e){var r,i,s,a,u,h,l;if(h={pad:[],trace:!1},e.cx=0,e.cy=0,i="tool-"+t+"-pad-"+o(),null!=e.dia&&null==e.vertices){if(null!=e.obround||null!=e.width||null!=e.height||null!=e.degrees)throw new Error(e+" contains invalid tool parameters");l="circle",null==e.hole&&(h.trace={"stroke-width":e.dia,fill:"none"})}else if(null!=e.width&&null!=e.height){if(null!=e.dia||null!=e.vertices||null!=e.degrees)throw new Error(e+" contains invalid tool parameters");l="rect",null!=e.hole||e.obround||(h.trace={})}else{if(null==e.dia||null==e.vertices)throw new Error(e+" contains invalid tool parameters");if(null!=e.obround||null!=e.width||null!=e.height)throw new Error(e+" contains invalid tool parameters");l="polygon"}if(u=n[l](e),null!=e.hole){if(null!=e.hole.dia&&null==e.hole.width&&null==e.hole.height)r=n.circle({cx:e.cx,cy:e.cy,dia:e.hole.dia}),r=r.shape,r.circle.fill="#000";else{if(null==e.hole.width||null==e.hole.height)throw new Error(e+" contains invalid tool hole parameters");r=n.rect({cx:e.cx,cy:e.cy,width:e.hole.width,height:e.hole.height}),r=r.shape,r.rect.fill="#000"}a=i+"-mask",s={mask:{id:i+"-mask",_:[{rect:{x:u.bbox[0],y:u.bbox[1],width:u.bbox[2]-u.bbox[0],height:u.bbox[3]-u.bbox[1],fill:"#fff"}},r]}},u.shape[l].mask="url(#"+a+")",h.pad.push(s)}return u.shape[l].id=i,h.pad.push(u.shape),h.bbox=u.bbox,h.padId=i,h},e.exports=i},{"./pad-shapes":91,"./unique-id":96}],95:[function(t,e,r){var n,i,o=[].indexOf||function(t){for(var e=0,r=this.length;r>e;e++)if(e in this&&this[e]===t)return e;return-1};n=3,i=function(t,e){var r,i,s,a,u,h,l,c,f,p,d,g,b,y;if(null==t)return NaN;if(t=""+t,i="",r="",b="+",("-"===t[0]||"+"===t[0])&&(b=t[0],t=t.slice(1)),o.call(t,".")>=0||null==e.zero){if(y=t.split("."),y.length>2)return NaN;p=[y[0],null!=(f=y[1])?f:""],i=p[0],r=p[1]}else{if("number"!=typeof(null!=e&&null!=(d=e.places)?d[0]:void 0)||"number"!=typeof(null!=e&&null!=(g=e.places)?g[1]:void 0))return NaN;if("T"===e.zero){for(a=u=0,l=t.length;l>u;a=++u)s=t[a],a<e.places[0]?i+=s:r+=s;for(;i.length<e.places[0];)i+="0"}else{if("L"!==e.zero)return NaN;for(a=h=0,c=t.length;c>h;a=++h)s=t[a],t.length-a<=e.places[1]?r+=s:i+=s;for(;r.length<e.places[1];)r="0"+r}}for(;r.length<n;)r+="0";return i+=r.slice(0,n),r=r.length>n?"."+r.slice(n):"",Number(b+i+r)},e.exports={get:i,factor:Math.pow(10,n)}},{}],96:[function(t,e,r){var n,i;i=1e3,n=function(){return i++},e.exports=n},{}],97:[function(t,e,r){var n;n=function(){function t(t,e){this.message=t,this.line=e}return t}(),e.exports=n},{}]},{},[87])(87)});

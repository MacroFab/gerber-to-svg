/* copyright 2015 by mike cousins and contributors; shared under the terms of the MIT license. Source code available at http:// github.com/mcous/gerber-to-svg */
!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,e.gerberToSvg=t()}}(function(){return function t(e,r,i){function o(s,l){if(!r[s]){if(!e[s]){var a="function"==typeof require&&require;if(!l&&a)return a(s,!0);if(n)return n(s,!0);var h=new Error("Cannot find module '"+s+"'");throw h.code="MODULE_NOT_FOUND",h}var u=r[s]={exports:{}};e[s][0].call(u.exports,function(t){var r=e[s][1][t];return o(r?r:t)},u,u.exports,t,e,r,i)}return r[s].exports}for(var n="function"==typeof require&&require,s=0;s<i.length;s++)o(i[s]);return o}({1:[function(t,e,r){var i;i=t("./svg-coord").get,e.exports=function(t,e){var r,o,n,s,l,a,h,u,c,f,p,d;if(null==t)return{};if(null==e.zero||null==e.places)throw new Error("format undefined");o={},p={},o.x=null!=(n=t.match(/X[+-]?[\d\.]+/))&&null!=(s=n[0])?s.slice(1):void 0,o.y=null!=(l=t.match(/Y[+-]?[\d\.]+/))&&null!=(a=l[0])?a.slice(1):void 0,o.i=null!=(h=t.match(/I[+-]?[\d\.]+/))&&null!=(u=h[0])?u.slice(1):void 0,o.j=null!=(c=t.match(/J[+-]?[\d\.]+/))&&null!=(f=c[0])?f.slice(1):void 0;for(r in o)d=o[r],null!=d&&(p[r]=i(d,e));return p}},{"./svg-coord":13}],2:[function(t,e,r){var i,o,n,s,l,a,h,u,c,f,p,d=function(t,e){function r(){this.constructor=t}for(var i in e)x.call(e,i)&&(t[i]=e[i]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t},x={}.hasOwnProperty;h=t("./parser"),f=t("./coord-parser"),c=t("./svg-coord").get,n={"FMAT,1":"M70","FMAT,2":"M72"},l="M71",i="G90",s="G91",p=/[XY]{1,2}/,u="L",a=[2,4],o=function(t){function e(){this.fmat="FMAT,2",e.__super__.constructor.call(this,arguments[0])}return d(e,t),e.prototype.parseCommand=function(t){var e,r,o,h,d,x,b,m,g,w,y,v;if(x={},";"===t[0])return x;if("FMAT,1"===t)this.fmat=t;else if("M30"===t||"M00"===t)x.set={done:!0};else if(t===n[this.fmat]||t.match(/INCH/))null==(e=this.format).places&&(e.places=[2,4]),x.set={units:"in"};else if(t===l||t.match(/METRIC/))null==(r=this.format).places&&(r.places=[3,3]),x.set={units:"mm"};else if(t===i)x.set={notation:"A"};else if(t===s)x.set={notation:"I"};else if(d=null!=(g=t.match(/T\d+/))?g[0]:void 0){for(;"0"===d[1];)d=d[0]+d.slice(2);(b=null!=(w=t.match(/C[\d\.]+(?=.*$)/))?w[0]:void 0)?(b=b.slice(1),x.tool={},x.tool[d]={dia:c(b,{places:this.format.places})}):x.set={currentTool:d}}if(t.match(/TZ/)?null==(o=this.format).zero&&(o.zero="L"):t.match(/LZ/)&&null==(h=this.format).zero&&(h.zero="T"),t.match(p)){x.op={"do":"flash"},null==this.format.zero&&(console.warn("no drill file zero suppression specified. assuming leading zero suppression (same as no zero suppression)"),this.format.zero=u),null==this.format.places&&(console.warn("no drill file units specified; assuming 2:4 inches format"),this.format.places=a),y=f(t,this.format);for(m in y)v=y[m],x.op[m]=v}return x},e}(h),e.exports=o},{"./coord-parser":1,"./parser":10,"./svg-coord":13}],3:[function(t,e,r){var i;i=function(){function t(t){this.line=0,this.blocks=t.split(/\r?\n/)}return t.prototype.nextBlock=function(){return this.line<this.blocks.length?this.blocks[++this.line-1]:!1},t}(),e.exports=i},{}],4:[function(t,e,r){var i,o,n,s,l,a=function(t,e){function r(){this.constructor=t}for(var i in e)h.call(e,i)&&(t[i]=e[i]);return r.prototype=e.prototype,t.prototype=new r,t.__super__=e.prototype,t},h={}.hasOwnProperty;o=t("./parser"),s=t("./coord-parser"),n=t("./svg-coord").get,l=/([XYIJ][+-]?\d+){1,4}/g,i=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.parseFormat=function(t,e){var r,i,o,n,s;if(s="L"===t[2]||"T"===t[2]?t[2]:null,o="A"===t[3]||"I"===t[3]?t[3]:null,"X"===t[4]&&"Y"===t[7]&&t.slice(5,7)===t.slice(8,10)&&t[5]<8&&t[6]<8&&(n=[+t[5],+t[6]]),null==n||null==o||null==s)throw new Error("invalid format specification");return null==(r=this.format).zero&&(r.zero=s),null==(i=this.format).places&&(i.places=n),null==e.set&&(e.set={}),e.set.notation=o},e.prototype.parseToolDef=function(t,e){var r,i,o,s,l,a,h;for(null==e.tool&&(e.tool={}),r=null!=(l=t.match(/^ADD\d{2,}/))?l[0].slice(2):void 0,a=t.slice(2+r.length).split(","),h=a[0],s=a[1],s=null!=s?s.split("X"):void 0;"0"===r[1];)r=r[0]+r.slice(2);switch(h){case"C":if(s.length>2?i={width:n(s[1],{places:this.format.places}),height:n(s[2],{places:this.format.places})}:s.length>1&&(i={dia:n(s[1],{places:this.format.places})}),e.tool[r]={dia:n(s[0],{places:this.format.places})},null!=i)return e.tool[r].hole=i;break;case"R":case"O":if(s.length>3?i={width:n(s[2],{places:this.format.places}),height:n(s[3],{places:this.format.places})}:s.length>2&&(i={dia:n(s[2],{places:this.format.places})}),e.tool[r]={width:n(s[0],{places:this.format.places}),height:n(s[1],{places:this.format.places})},"O"===h&&(e.tool[r].obround=!0),null!=i)return e.tool[r].hole=i;break;case"P":if(s.length>4?i={width:n(s[3],{places:this.format.places}),height:n(s[4],{places:this.format.places})}:s.length>3&&(i={dia:n(s[3],{places:this.format.places})}),e.tool[r]={dia:n(s[0],{places:this.format.places}),verticies:+s[1]},s.length>2&&(e.tool[r].degrees=+s[2]),null!=i)return e.tool[r].hole=i;break;default:return s=function(){var t,e,r,i;for(r=null!=s?s:[],i=[],t=0,e=r.length;e>t;t++)o=r[t],i.push(+o);return i}(),e.tool[r]={macro:h,mods:s}}},e.prototype.parseCommand=function(t){var e,r,i,o,a,h,u,c,f,p,d,x,b,m,g,w,y,v,M,k,E,q,_,R,T,B,z;if(null==t&&(t={}),r={},x=t.param)for(u=0,c=x.length;c>u;u++)switch(d=x[u],i=d.slice(0,2)){case"FS":this.parseFormat(d,r);break;case"MO":if(R=d.slice(2,4),null==r.set&&(r.set={}),"IN"===R)r.set.units="in";else{if("MM"!==R)throw new Error(d+" is an invalid units setting");r.set.units="mm"}break;case"AD":this.parseToolDef(d,r);break;case"AM":return{macro:x};case"LP":if(null==r["new"]&&(r["new"]={}),("D"===d[2]||"C"===d[2])&&(r["new"].layer=d[2]),null==r["new"].layer)throw new Error("invalid level polarity");break;case"SR":if(null==r["new"]&&(r["new"]={}),B=null!=(b=null!=(m=d.match(/X[+-]?[\d\.]+/))?m[0].slice(1):void 0)?b:1,z=null!=(g=null!=(w=d.match(/Y[+-]?[\d\.]+/))?w[0].slice(1):void 0)?g:1,a=null!=(y=d.match(/I[+-]?[\d\.]+/))?y[0].slice(1):void 0,h=null!=(v=d.match(/J[+-]?[\d\.]+/))?v[0].slice(1):void 0,1>B||1>z||B>1&&(null==a||0>a)||z>1&&(null==h||0>h))throw new Error("invalid step repeat");r["new"].sr={x:+B,y:+z},null!=a&&(r["new"].sr.i=n(a,{places:this.format.places})),null!=h&&(r["new"].sr.j=n(h,{places:this.format.places}))}else if(t=t.block){if("M02"===t)return{set:{done:!0}};if("G"===t[0])switch(i=null!=(M=t.slice(1).match(/^\d{1,2}/))?M[0]:void 0){case"4":case"04":return{};case"1":case"01":case"2":case"02":case"3":case"03":i=i[i.length-1],f="1"===i?"i":"2"===i?"cw":"ccw",r.set={mode:f};break;case"36":case"37":r.set={region:"36"===i};break;case"70":case"71":r.set={backupUnits:"70"===i?"in":"mm"};break;case"74":case"75":r.set={quad:"74"===i?"s":"m"}}if(o=s(null!=(k=t.match(l))?k[0]:void 0,this.format),p=(null!=(E=t.match(/D0?[123]$/))?E[0]:void 0)||Object.keys(o).length){null!=p&&(p=p[p.length-1]),p=function(){switch(p){case"1":return"int";case"2":return"move";case"3":return"flash";default:return"last"}}(),r.op={"do":p};for(e in o)T=o[e],r.op[e]=T}else(_=null!=(q=t.match(/D\d+$/))?q[0]:void 0)&&(r.set={currentTool:_})}return r},e}(o),e.exports=i},{"./coord-parser":1,"./parser":10,"./svg-coord":13}],5:[function(t,e,r){var i;i=function(){function t(t){this.gerberFile=null!=t?t:"",this.line=0,this.charIndex=0,this.end=this.gerberFile.length}return t.prototype.nextBlock=function(){var t,e,r;if(this.index>=this.end)return!1;for(e="",r=!1,0===this.line&&this.line++;!(this.charIndex>=this.end);)if(t=this.gerberFile[this.charIndex++],"%"===t){if(r)return{param:r};r=[]}else if("*"===t){if(!r)return{block:e};r.push(e),e=""}else"\n"===t?this.line++:t>=" "&&"~">=t&&(e+=t);return!1},t.prototype.getLine=function(){return this.line},t}(),e.exports=i},{}],6:[function(t,e,r){var i,o,n,s,l,a;o=/[\+\-\/xX\(\)]/,i=/[\$\d\.]+/,n=new RegExp("("+o.source+")|("+i.source+")","g"),a=function(t){var e;return e=t.match(n)},s=function(t){return i.test(t)},l=function(t){var e,r,i,o,n,l,h;return h=a(t),r=0,l=function(){return h[r]},e=function(t){return t===l()?r++:void 0},n=function(){var t,r;if(r=l(),e(r),s(r))t={type:"n",val:r};else{if("("!==r)throw new Error(r+" is unexpected in an arithmetic string");if(t=i(),")"!==l())throw new Error("expected ')'");e(")")}return t},o=function(){var t,r,i;for(t=n(),i=l();"x"===i||"/"===i||"X"===i;)e(i),"X"===i&&(console.warn("Warning: uppercase 'X' as multiplication symbol is incorrect; macros should use lowercase 'x' to multiply"),i="x"),r=n(),t={type:i,left:t,right:r},i=l();return t},(i=function(){var t,r,i;for(t=o(),i=l();"+"===i||"-"===i;)e(i),r=o(),t={type:i,left:t,right:r},i=l();return t})()},e.exports={tokenize:a,isNumber:s,parse:l}},{}],7:[function(t,e,r){var i,o,n,s,l;s=t("./pad-shapes"),o=t("./macro-calc"),l=t("./unique-id"),n=t("./svg-coord").get,i=function(){function t(t,e){this.modifiers={},this.name=t[0].slice(2),this.blocks=t.slice(1),this.shapes=[],this.masks=[],this.lastExposure=null,this.bbox=[null,null,null,null],this.format={places:e}}return t.prototype.run=function(t,e){var r,i,o,n,s,a,h,u,c,f,p,d,x,b,m,g,w,y,v;for(null==e&&(e=[]),this.lastExposure=null,this.shapes=[],this.masks=[],this.bbox=[null,null,null,null],this.modifiers={},o=n=0,h=e.length;h>n;o=++n)p=e[o],this.modifiers["$"+(o+1)]=p;for(m=this.blocks,s=0,u=m.length;u>s;s++)r=m[s],this.runBlock(r);for(b="tool-"+t+"-pad-"+l(),x=[],g=this.masks,a=0,c=g.length;c>a;a++)p=g[a],x.push(p);if(this.shapes.length>1){for(i={id:b,_:[]},w=this.shapes,d=0,f=w.length;f>d;d++)y=w[d],i._.push(y);x=[{g:i}]}else 1===this.shapes.length&&(v=Object.keys(this.shapes[0])[0],this.shapes[0][v].id=b,x.push(this.shapes[0]));return{pad:x,padId:b,bbox:this.bbox,trace:!1}},t.prototype.runBlock=function(t){var e,r,i,o,n,s,l,a;switch(t[0]){case"$":return s=null!=(l=t.match(/^\$\d+(?=\=)/))?l[0]:void 0,a=t.slice(1+s.length),this.modifiers[s]=this.getNumber(a);case"1":case"2":case"20":case"21":case"22":case"4":case"5":case"6":case"7":for(r=t.split(","),i=o=0,n=r.length;n>o;i=++o)e=r[i],r[i]=this.getNumber(e);return this.primitive(r);default:if("0"!==t[0])throw new Error("'"+t+"' unrecognized tool macro block")}},t.prototype.primitive=function(t){var e,r,i,o,a,h,u,c,f,p,d,x,b,m,g,w,y,v,M,k,E,q,_,R,T,B,z,A,D;switch(b=!1,z=!1,D=null,t[0]){case 1:D=s.circle({dia:n(t[2],this.format),cx:n(t[3],this.format),cy:n(t[4],this.format)}),0===t[1]?b=!0:this.addBbox(D.bbox);break;case 2:case 20:D=s.vector({width:n(t[2],this.format),x1:n(t[3],this.format),y1:n(t[4],this.format),x2:n(t[5],this.format),y2:n(t[6],this.format)}),t[7]&&(D.shape.line.transform="rotate("+t[7]+")"),0===t[1]?b=!0:this.addBbox(D.bbox,t[7]);break;case 21:D=s.rect({cx:n(t[4],this.format),cy:n(t[5],this.format),width:n(t[2],this.format),height:n(t[3],this.format)}),t[6]&&(D.shape.rect.transform="rotate("+t[6]+")"),0===t[1]?b=!0:this.addBbox(D.bbox,t[6]);break;case 22:D=s.lowerLeftRect({x:n(t[4],this.format),y:n(t[5],this.format),width:n(t[2],this.format),height:n(t[3],this.format)}),t[6]&&(D.shape.rect.transform="rotate("+t[6]+")"),0===t[1]?b=!0:this.addBbox(D.bbox,t[6]);break;case 4:for(y=[],r=i=3,M=3+2*t[2];M>=i;r=i+=2)y.push([n(t[r],this.format),n(t[r+1],this.format)]);D=s.outline({points:y}),(B=t[t.length-1])&&(D.shape.polygon.transform="rotate("+B+")"),0===t[1]?b=!0:this.addBbox(D.bbox,t[t.length-1]);break;case 5:if(0!==t[6]&&(0!==t[3]||0!==t[4]))throw new RangeError("polygon center must be 0,0 if rotated in macro");D=s.polygon({cx:n(t[3],this.format),cy:n(t[4],this.format),dia:n(t[5],this.format),verticies:t[2],degrees:t[6]}),0===t[1]?b=!0:this.addBbox(D.bbox);break;case 6:if(0!==t[9]&&(0!==t[1]||0!==t[2]))throw new RangeError("moiré center must be 0,0 if rotated in macro");if(D=s.moire({cx:n(t[1],this.format),cy:n(t[2],this.format),outerDia:n(t[3],this.format),ringThx:n(t[4],this.format),ringGap:n(t[5],this.format),maxRings:t[6],crossThx:n(t[7],this.format),crossLength:n(t[8],this.format)}),t[9])for(k=D.shape,o=0,u=k.length;u>o;o++)A=k[o],null!=A.line&&(A.line.transform="rotate("+t[9]+")");this.addBbox(D.bbox,t[9]);break;case 7:if(0!==t[9]&&(0!==t[1]||0!==t[2]))throw new RangeError("thermal center must be 0,0 if rotated in macro");if(D=s.thermal({cx:n(t[1],this.format),cy:n(t[2],this.format),outerDia:n(t[3],this.format),innerDia:n(t[4],this.format),gap:n(t[5],this.format)}),t[6])for(E=D.shape,h=0,c=E.length;c>h;h++)if(A=E[h],null!=A.mask)for(q=A.mask._,g=0,f=q.length;f>g;g++)x=q[g],null!=x.rect&&(x.rect.transform="rotate("+t[6]+")");this.addBbox(D.bbox,t[6]);break;default:throw new Error(t[0]+" is not a valid primitive code")}if(b){for(a in D.shape)D.shape[a].fill="#000";if(0!==this.lastExposure){if(this.lastExposure=0,m="macro-"+this.name+"-mask-"+l(),x={mask:{id:m}},x.mask._=[{rect:{x:this.bbox[0],y:this.bbox[1],width:this.bbox[2]-this.bbox[0],height:this.bbox[3]-this.bbox[1],fill:"#fff"}}],1===this.shapes.length)for(a in this.shapes[0])this.shapes[0][a].mask="url(#"+m+")";else if(this.shapes.length>1){for(e={mask:"url(#"+m+")",_:[]},_=this.shapes,w=0,p=_.length;p>w;w++)A=_[w],e._.push(A);this.shapes=[{g:e}]}this.masks.push(x)}return this.masks[this.masks.length-1].mask._.push(D.shape)}if(this.lastExposure=1,Array.isArray(D.shape)){for(R=D.shape,T=[],v=0,d=R.length;d>v;v++)A=R[v],null!=A.mask?T.push(this.masks.push(A)):T.push(this.shapes.push(A));return T}return this.shapes.push(D.shape)},t.prototype.addBbox=function(t,e){var r,i,o,n,s,l,a,h,u;if(null==e&&(e=0),e){for(a=Math.sin(e*Math.PI/180),i=Math.cos(e*Math.PI/180),Math.abs(a)<1e-9&&(a=0),Math.abs(i)<1e-9&&(i=0),l=[[t[0],t[1]],[t[2],t[1]],[t[2],t[3]],[t[0],t[3]]],o=0,n=l.length;n>o;o++)s=l[o],h=s[0]*i-s[1]*a,u=s[0]*a+s[1]*i,(null===this.bbox[0]||h<this.bbox[0])&&(this.bbox[0]=h),(null===this.bbox[1]||u<this.bbox[1])&&(this.bbox[1]=u),(null===this.bbox[2]||h>this.bbox[2])&&(this.bbox[2]=h),(null===this.bbox[3]||u>this.bbox[3])&&(this.bbox[3]=u);return this.bbox=function(){var t,e,i,o;for(i=this.bbox,o=[],t=0,e=i.length;e>t;t++)r=i[t],o.push(r===-0?0:r);return o}.call(this)}return(null===this.bbox[0]||t[0]<this.bbox[0])&&(this.bbox[0]=t[0]),(null===this.bbox[1]||t[1]<this.bbox[1])&&(this.bbox[1]=t[1]),(null===this.bbox[2]||t[2]>this.bbox[2])&&(this.bbox[2]=t[2]),null===this.bbox[3]||t[3]>this.bbox[3]?this.bbox[3]=t[3]:void 0},t.prototype.getNumber=function(t){return t.match(/^[+-]?[\d.]+$/)?Number(t):t.match(/^\$\d+$/)?Number(this.modifiers[t]):this.evaluate(o.parse(t))},t.prototype.evaluate=function(t){switch(t.type){case"n":return this.getNumber(t.val);case"+":return this.evaluate(t.left)+this.evaluate(t.right);case"-":return this.evaluate(t.left)-this.evaluate(t.right);case"x":return this.evaluate(t.left)*this.evaluate(t.right);case"/":return this.evaluate(t.left)/this.evaluate(t.right)}},t}(),e.exports=i},{"./macro-calc":6,"./pad-shapes":9,"./svg-coord":13,"./unique-id":14}],8:[function(t,e,r){var i,o,n,s;s=function(t,e){var r;if(r="",0===e)return"";for(;e>1;)1&e&&(r+=t),e>>=1,t+=t;return r+t},i="_",o="  ",n=function(t,e){var r,l,a,h,u,c,f,p,d,x,b,m,g,w,y,v,M,k,E;if(null==e&&(e={}),m=e.pretty,c=null!=(g=e.indent)?g:0,l=null!=(w=e.maxDec)?w:!1,a=function(t){return"number"==typeof t?Number(t.toFixed(l)):t},x=m?"\n":"",v=x?"string"==typeof m?m:o:"",v=s(v,c),E="","function"==typeof t&&(t=t()),Array.isArray(t))for(u=f=0,d=t.length;d>f;u=++f)b=t[u],E+=(0!==u?x:"")+n(b,e);else if("object"==typeof t){if(r=!1,h=Object.keys(t)[0],null!=h){E=v+"<"+h,"function"==typeof t[h]&&(t[h]=t[h]()),y=t[h];for(p in y)k=y[p],"function"==typeof k&&(k=k()),p===i?r=k:(Array.isArray(k)&&(l&&(k=function(){var t,e,r;for(r=[],t=0,e=k.length;e>t;t++)M=k[t],r.push(a(M));return r}()),k=k.join(" ")),l&&(k=a(k)),E+=" "+p+'="'+k+'"');r&&(E+=">"+x+n(r,{pretty:m,indent:c+1})),E+=null!=t[h]._?""+x+v+"</"+h+">":"/>"}}else E+=t+" ";return E},e.exports=n},{}],9:[function(t,e,r){var i,o,n,s,l,a,h,u,c;u=t("./unique-id"),i=function(t){var e;if(null==t.dia)throw new Error("circle function requires diameter");if(null==t.cx)throw new Error("circle function requires x center");if(null==t.cy)throw new Error("circle function requires y center");return e=t.dia/2,{shape:{circle:{cx:t.cx,cy:t.cy,r:e}},bbox:[t.cx-e,t.cy-e,t.cx+e,t.cy+e]}},a=function(t){var e,r,i,o;if(null==t.width)throw new Error("rectangle requires width");if(null==t.height)throw new Error("rectangle requires height");if(null==t.cx)throw new Error("rectangle function requires x center");if(null==t.cy)throw new Error("rectangle function requires y center");return i=t.cx-t.width/2,o=t.cy-t.height/2,r={shape:{rect:{x:i,y:o,width:t.width,height:t.height}},bbox:[i,o,i+t.width,o+t.height]},t.obround&&(e=.5*Math.min(t.width,t.height),r.shape.rect.rx=e,r.shape.rect.ry=e),r},l=function(t){var e,r,i,o,n,s,l,a,h,u,c,f,p,d,x,b;if(null==t.dia)throw new Error("polygon requires diameter");if(null==t.verticies)throw new Error("polygon requires verticies");if(null==t.cx)throw new Error("polygon function requires x center");if(null==t.cy)throw new Error("polygon function requires y center");for(a=null!=t.degrees?t.degrees*Math.PI/180:0,h=2*Math.PI/t.verticies,o=t.dia/2,i="",p=null,b=null,f=null,x=null,e=r=0,n=t.verticies;n>=0?n>r:r>n;e=n>=0?++r:--r)u=a+e*h,s=o*Math.cos(u),l=o*Math.sin(u),Math.abs(s)<1e-9&&(s=0),Math.abs(l)<1e-9&&(l=0),c=t.cx+s,d=t.cy+l,(p>c||null===p)&&(p=c),(c>f||null===f)&&(f=c),(b>d||null===b)&&(b=d),(d>x||null===x)&&(x=d),i+=" "+c+","+d;return{shape:{polygon:{points:i.slice(1)}},bbox:[p,b,f,x]}},c=function(t){var e,r,i;if(null==t.x1)throw new Error("vector function requires start x");if(null==t.y1)throw new Error("vector function requires start y");if(null==t.x2)throw new Error("vector function requires end x");if(null==t.y2)throw new Error("vector function requires end y");if(null==t.width)throw new Error("vector function requires width");return e=Math.abs(Math.atan((t.y2-t.y1)/(t.x2-t.x1))),r=t.width/2*Math.sin(e),i=t.width/2*Math.cos(e),1e-7>r&&(r=0),1e-7>i&&(i=0),{shape:{line:{x1:t.x1,x2:t.x2,y1:t.y1,y2:t.y2,"stroke-width":t.width,"stroke-linecap":"butt"}},bbox:[Math.min(t.x1,t.x2)-r,Math.min(t.y1,t.y2)-i,Math.max(t.x1,t.x2)+r,Math.max(t.y1,t.y2)+i]}},o=function(t){if(null==t.width)throw new Error("lower left rect requires width");if(null==t.height)throw new Error("lower left rect requires height");if(null==t.x)throw new Error("lower left rectangle requires x");if(null==t.y)throw new Error("lower left rectangle requires y");return{shape:{rect:{x:t.x,y:t.y,width:t.width,height:t.height}},bbox:[t.x,t.y,t.x+t.width,t.y+t.height]}},s=function(t){var e,r,i,o,n,s,l,a,h,u,c,f,p;if(!(Array.isArray(t.points)&&t.points.length>1))throw new Error("outline function requires points array");for(h=null,p=null,a=null,f=null,o="",n=t.points,e=0,r=n.length;r>e;e++){if(i=n[e],!Array.isArray(i)||2!==i.length)throw new Error("outline function requires points array");s=i[0],u=i[1],(h>s||null===h)&&(h=s),(s>a||null===a)&&(a=s),(p>u||null===p)&&(p=u),(u>f||null===f)&&(f=u),o+=" "+s+","+u}if(l=t.points[t.points.length-1][0],c=t.points[t.points.length-1][1],l!==t.points[0][0]||c!==t.points[0][1])throw new RangeError("last point must match first point of outline");return{shape:{polygon:{points:o.slice(1)}},bbox:[h,p,a,f]}},n=function(t){var e,r,i;if(null==t.cx)throw new Error("moiré requires x center");if(null==t.cy)throw new Error("moiré requires y center");if(null==t.outerDia)throw new Error("moiré requires outer diameter");if(null==t.ringThx)throw new Error("moiré requires ring thickness");if(null==t.ringGap)throw new Error("moiré requires ring gap");if(null==t.maxRings)throw new Error("moiré requires max rings");if(null==t.crossLength)throw new Error("moiré requires crosshair length");if(null==t.crossThx)throw new Error("moiré requires crosshair thickness");for(i=[{line:{x1:t.cx-t.crossLength/2,y1:0,x2:t.cx+t.crossLength/2,y2:0,"stroke-width":t.crossThx,"stroke-linecap":"butt"}},{line:{x1:0,y1:t.cy-t.crossLength/2,x2:0,y2:t.cy+t.crossLength/2,"stroke-width":t.crossThx,"stroke-linecap":"butt"}}],e=(t.outerDia-t.ringThx)/2,r=0;e>=t.ringThx&&r<t.maxRings;)i.push({circle:{cx:t.cx,cy:t.cy,r:e,fill:"none","stroke-width":t.ringThx}}),r++,e-=t.ringThx+t.ringGap;return e+=.5*t.ringThx,e>0&&r<t.maxRings&&i.push({circle:{cx:t.cx,cy:t.cy,r:e}}),{shape:i,bbox:[Math.min(t.cx-t.crossLength/2,t.cx-t.outerDia/2),Math.min(t.cy-t.crossLength/2,t.cy-t.outerDia/2),Math.max(t.cx+t.crossLength/2,t.cx+t.outerDia/2),Math.max(t.cy+t.crossLength/2,t.cy+t.outerDia/2)]}},h=function(t){var e,r,i,o,n,s,l,a,h;if(null==t.cx)throw new Error("thermal requires x center");if(null==t.cy)throw new Error("thermal requires y center");if(null==t.outerDia)throw new Error("thermal requires outer diameter");if(null==t.innerDia)throw new Error("thermal requires inner diameter");if(null==t.gap)throw new Error("thermal requires gap");return r="thermal-mask-"+u(),n=(t.outerDia-t.innerDia)/2,i=t.outerDia/2,o=i-n/2,l=t.cx-i,s=t.cx+i,h=t.cy-i,a=t.cy+i,e=t.gap/2,{shape:[{mask:{id:r,_:[{circle:{cx:t.cx,cy:t.cy,r:i,fill:"#fff"}},{rect:{x:l,y:-e,width:t.outerDia,height:t.gap,fill:"#000"}},{rect:{x:-e,y:h,width:t.gap,height:t.outerDia,fill:"#000"}}]}},{circle:{cx:t.cx,cy:t.cy,r:o,fill:"none","stroke-width":n,mask:"url(#"+r+")"}}],bbox:[l,h,s,a]}},e.exports={circle:i,rect:a,polygon:l,vector:c,lowerLeftRect:o,outline:s,moire:n,thermal:h}},{"./unique-id":14}],10:[function(t,e,r){var i;i=function(){function t(t){var e,r;if(null==t&&(t={}),this.format={zero:null!=(e=t.zero)?e:null,places:null!=(r=t.places)?r:null},null!=this.format.places&&(!Array.isArray(this.format.places)||2!==this.format.places.length||"number"!=typeof this.format.places[0]||"number"!=typeof this.format.places[1]))throw new Error("parser places format must be an array of two numbers");if(null!=this.format.zero&&("string"!=typeof this.format.zero||"L"!==this.format.zero&&"T"!==this.format.zero))throw new Error("parser zero format must be either 'L' or 'T'")}return t}(),e.exports=i},{}],11:[function(t,e,r){var i,o,n,s,l,a,h,u,c;c=t("./unique-id"),n=t("./macro-tool"),u=t("./standard-tool"),h=t("./svg-coord").factor,o=Math.PI/2,l=3*o,a=2*Math.PI,i="in",s=function(){function t(t,e,r){var i,o;this.reader=t,this.parser=e,null==r&&(r={}),this.units=null!=(i=r.units)?i:null,this.notation=null!=(o=r.notation)?o:null,this.macros={},this.tools={},this.currentTool="",this.defs=[],this.group={g:{_:[]}},this.polarity="D",this.current=[],this.stepRepeat={x:1,y:1,i:0,j:0},this.srOverClear=!1,this.srOverCurrent=[],this.mode=null,this.quad=null,this.lastOp=null,this.region=!1,this.done=!1,this.pos={x:0,y:0},this.path=[],this.attr={"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":0,stroke:"#000"},this.bbox={xMin:1/0,yMin:1/0,xMax:-(1/0),yMax:-(1/0)},this.layerBbox={xMin:1/0,yMin:1/0,xMax:-(1/0),yMax:-(1/0)}}return t.prototype.addTool=function(t,e){var r,i;if(null!=this.tools[t])throw new Error("cannot reassign tool "+t);return i=null!=e.macro?this.macros[e.macro].run(t,e.mods):u(t,e),this.tools[t]={trace:i.trace,pad:function(){var t,e,o,n;for(o=i.pad,n=[],t=0,e=o.length;e>t;t++)r=o[t],n.push(r);return n}(),flash:function(t,e){return{use:{x:t,y:e,"xlink:href":"#"+i.padId}}},flashed:!1,bbox:function(t,e){return null==t&&(t=0),null==e&&(e=0),{xMin:t+i.bbox[0],yMin:e+i.bbox[1],xMax:t+i.bbox[2],yMax:e+i.bbox[3]}}},this.changeTool(t)},t.prototype.changeTool=function(t){var e;if(this.finishPath(),this.region)throw new Error("cannot change tool when in region mode");if(null!=this.tools[t])return this.currentTool=t;if(!(null!=(e=this.parser)?e.fmat:void 0))throw new Error("tool "+t+" is not defined")},t.prototype.command=function(t){var e,r,i,o,s,l,a;if(null!=t.macro)return r=new n(t.macro,this.parser.format.places),void(this.macros[r.name]=r);o=t.set;for(l in o)switch(a=o[l],"region"===l&&this.finishPath(),l){case"currentTool":this.changeTool(a);break;case"units":case"notation":null==this[l]&&(this[l]=a);break;default:this[l]=a}if(null!=t.tool){s=t.tool;for(e in s)i=s[e],this.addTool(e,i)}if(null!=t.op&&this.operate(t.op),null!=t["new"]){if(this.finishLayer(),null!=t["new"].layer)return this.polarity=t["new"].layer;if(null!=t["new"].sr)return this.finishSR(),this.stepRepeat=t["new"].sr}},t.prototype.plot=function(){for(var t,e;!this.done;){if(t=this.reader.nextBlock(),t===!1)throw null==(null!=(e=this.parser)?e.fmat:void 0)?new Error("end of file encountered before required M02 command"):new Error("end of drill file encountered before M00/M30 command");this.command(this.parser.parseCommand(t))}return this.finish()},t.prototype.finish=function(){return this.finishPath(),this.finishLayer(),this.finishSR(),this.group.g.fill="currentColor",this.group.g.stroke="currentColor",this.group.g.transform="translate(0,"+(this.bbox.yMin+this.bbox.yMax)+") scale(1,-1)"},t.prototype.finishSR=function(){var t,e,r,i,o,n,s,l,a,h,u,f,p,d,x,b;if(this.srOverClear&&this.srOverCurrent){for(n="gerber-sr-mask_"+c(),o={mask:{color:"#000",id:n,_:[]}},o.mask._.push({rect:{fill:"#fff",x:this.bbox.xMin,y:this.bbox.yMin,width:this.bbox.xMax-this.bbox.xMin,height:this.bbox.yMax-this.bbox.yMin}}),x=t=0,l=this.stepRepeat.x*this.stepRepeat.i,a=this.stepRepeat.i;a>0?l>t:t>l;x=t+=a)for(b=e=0,h=this.stepRepeat.y*this.stepRepeat.j,u=this.stepRepeat.j;u>0?h>e:e>h;b=e+=u)for(f=this.srOverCurrent,s=0,i=f.length;i>s;s++)r=f[s],d={use:{}},0!==x&&(d.use.x=x),0!==b&&(d.use.y=b),d.use["xlink:href"]="#"+(null!=(p=r.C)?p:r.D),null!=r.D&&(d.use.fill="#fff"),o.mask._.push(d);return this.srOverClear=!1,this.srOverCurrent=[],this.defs.push(o),this.group.g.mask="url(#"+n+")"}},t.prototype.finishLayer=function(){var t,e,r,i,o,n,s,l,a,h,u,f,p,d,x,b;if(this.finishPath(),this.current.length){if(this.stepRepeat.x>1||this.stepRepeat.y>1){for(f="gerber-sr_"+c(),this.current=[{g:{id:f,_:this.current}}],(this.srOverClear||this.stepRepeat.i<this.layerBbox.xMax-this.layerBbox.xMin||this.stepRepeat.j<this.layerBbox.yMax-this.layerBbox.yMin)&&(l={},l[this.polarity]=f,this.srOverCurrent.push(l),"C"===this.polarity&&(this.srOverClear=!0,this.defs.push(this.current[0]))),x=i=0,a=this.stepRepeat.x;a>=0?a>i:i>a;x=a>=0?++i:--i)for(b=o=0,h=this.stepRepeat.y;h>=0?h>o:o>h;b=h>=0?++o:--o)(0!==x||0!==b)&&(p={use:{"xlink:href":"#"+f}},0!==x&&(p.use.x=x*this.stepRepeat.i),0!==b&&(p.use.y=b*this.stepRepeat.j),this.current.push(p));this.layerBbox.xMax+=(this.stepRepeat.x-1)*this.stepRepeat.i,this.layerBbox.yMax+=(this.stepRepeat.y-1)*this.stepRepeat.j}if(this.addBbox(this.layerBbox,this.bbox),this.layerBbox={xMin:1/0,yMin:1/0,xMax:-(1/0),yMax:-(1/0)},"D"===this.polarity)if(null!=this.group.g.mask&&this.current.unshift(this.group),null==this.group.g.mask&&this.group.g._.length)for(u=this.current,s=0,n=u.length;n>s;s++)t=u[s],this.group.g._.push(t);else this.group={g:{_:this.current}};else"C"!==this.polarity||this.srOverClear||(r="gerber-mask_"+c(),d=this.bbox.xMax-this.bbox.xMin,e=this.bbox.yMax-this.bbox.yMin,this.current.unshift({rect:{x:this.bbox.xMin,y:this.bbox.yMin,width:d,height:e,fill:"#fff"}}),this.defs.push({mask:{id:r,color:"#000",_:this.current}}),this.group.g.mask="url(#"+r+")");return this.current=[]}},t.prototype.finishPath=function(){var t,e,r,i;if(this.path.length){if(e={path:{}},this.region)this.path.push("Z");else{r=this.tools[this.currentTool].trace;for(t in r)i=r[t],e.path[t]=i}return e.path.d=this.path,this.current.push(e),this.path=[]}},t.prototype.operate=function(t){var e,r,o,n,s,l,a,h,u,c,f,p,d,x,b,m,g;if("last"===t["do"]?(t["do"]=this.lastOp,console.warn("modal operation codes are deprecated")):this.lastOp=t["do"],b=this.pos.x,m=this.pos.y,"I"===this.notation?(this.pos.x+=null!=(l=t.x)?l:0,this.pos.y+=null!=(a=t.y)?a:0):(this.pos.x=null!=(h=t.x)?h:this.pos.x,this.pos.y=null!=(u=t.y)?u:this.pos.y),r=this.pos.x,o=this.pos.y,g=this.tools[this.currentTool],null==this.units&&(null!=this.backupUnits?(this.units=this.backupUnits,console.warn("units set to '"+this.units+"' according to deprecated command G7"+("in"===this.units?0:1))):(this.units=i,console.warn("no units set; assuming inches"))),null==this.notation){if(null==(null!=(c=this.parser)?c.fmat:void 0))throw new Error("format has not been set");this.notation="A"}if("move"===t["do"]&&this.path.length)return this.path.push("M",r,o);if("flash"===t["do"]){if(this.finishPath(),this.region)throw new Error("cannot flash while in region mode");if(!g.flashed){for(f=g.pad,n=0,s=f.length;s>n;n++)x=f[n],this.defs.push(x);g.flashed=!0}return this.current.push(g.flash(r,o)),this.addBbox(g.bbox(r,o),this.layerBbox)}if("int"===t["do"]){if(!this.region&&!g.trace)throw new Error(this.currentTool+" is not a strokable tool");return 0===this.path.length&&(this.path.push("M",b,m),e=this.region?{xMin:b,yMin:m,xMax:b,yMax:m}:g.bbox(b,m),this.addBbox(e,this.layerBbox)),null==this.mode&&(this.mode="i",console.warn("no interpolation mode set. Assuming linear (G01)")),"i"===this.mode?this.drawLine(b,m,r,o):this.drawArc(b,m,r,o,null!=(p=t.i)?p:0,null!=(d=t.j)?d:0)}},t.prototype.drawLine=function(t,e,r,i){var n,s,l,a,h,u,c,f,p,d,x,b,m;return b=this.tools[this.currentTool],n=this.region?{xMin:r,yMin:i,xMax:r,yMax:i}:b.bbox(r,i),this.addBbox(n,this.layerBbox),this.region||b.trace["stroke-width"]>=0?this.path.push("L",r,i):(c=b.pad[0].rect.width/2,u=b.pad[0].rect.height/2,f=t-c,p=t+c,d=e-u,x=e+u,s=r-c,l=r+c,a=i-u,h=i+u,m=Math.atan2(i-e,r-t),m>=0&&o>m?this.path.push("M",f,d,p,d,l,a,l,h,s,h,f,x,"Z"):m>=o&&m<=Math.PI?this.path.push("M",f,d,p,d,p,x,l,h,s,h,s,a,"Z"):-Math.PI<=m&&-o>m?this.path.push("M",p,d,p,x,f,x,s,h,s,a,l,a,"Z"):m>=-o&&0>m?this.path.push("M",f,d,s,a,l,a,l,h,p,x,f,x,"Z"):void 0)},t.prototype.drawArc=function(t,e,r,i,n,s){var u,c,f,p,d,x,b,m,g,w,y,v,M,k,E,q,_,R,T,B,z,A,D,L,I,O,C,j,P,N;if(u=1.5*h*Math.pow(10,-1*(null!=(M=null!=(k=this.parser)?k.format.places[1]:void 0)?M:7)),_=this.tools[this.currentTool],!this.region&&!_.trace["stroke-width"])throw Error("cannot stroke an arc with non-circular tool "+this.currentTool);if(null==this.quad)throw new Error("arc quadrant mode has not been set");for(y=Math.sqrt(Math.pow(n,2)+Math.pow(s,2)),q="cw"===this.mode?0:1,m=0,z=[],f=[[t+n,e+s]],"s"===this.quad&&f.push([t-n,e-s],[t-n,e+s],[t+n,e-s]),x=0,g=f.length;g>x;x++)c=f[x],d=Math.sqrt(Math.pow(c[0]-r,2)+Math.pow(c[1]-i,2)),Math.abs(y-d)<u&&z.push({x:c[0],y:c[1]});for(T=0,B=0,p=null,b=0,w=z.length;w>b&&(c=z[b],T=Math.atan2(i-c.y,r-c.x),0>T&&(T+=a),B=Math.atan2(e-c.y,t-c.x),0>B&&(B+=a),"cw"===this.mode&&T>B?B+=a:"ccw"===this.mode&&B>T&&(T+=a),R=Math.abs(T-B),"s"===this.quad&&o>=R?p=c:"m"===this.quad&&(R>=Math.PI&&(m=1),p={x:c.x,y:c.y}),null==p);b++);return null==p?void console.warn("start "+t+","+e+" "+this.mode+" to end "+r+","+i+" with center offset "+n+","+s+" is an impossible arc in "+("s"===this.quad?"single":"multi")+" quadrant mode with epsilon set to "+u):(v=this.region?0:_.bbox().xMax,"cw"===this.mode&&(E=[B,T],T=E[0],B=E[1]),I=B>0?a:0,P=o+(B>o?a:0),L=Math.PI+(B>Math.PI?a:0),j=l+(B>l?a:0),D=L>=B&&T>=L?p.x-y-v:Math.min(t,r)-v,A=I>=B&&T>=I?p.x+y+v:Math.max(t,r)+v,C=j>=B&&T>=j?p.y-y-v:Math.min(e,i)-v,O=P>=B&&T>=P?p.y+y+v:Math.max(e,i)+v,N=Math.abs(t-r)<u&&Math.abs(e-i)<u,"m"===this.quad&&N&&(this.path.push("A",y,y,0,0,q,r+2*n,i+2*s),D=p.x-y-v,C=p.y-y-v,A=p.x+y+v,O=p.y+y+v),this.path.push("A",y,y,0,m,q,r,i),"s"===this.quad&&N&&this.path.push("Z"),this.addBbox({xMin:D,yMin:C,xMax:A,yMax:O},this.layerBbox))},t.prototype.addBbox=function(t,e){return t.xMin<e.xMin&&(e.xMin=t.xMin),t.yMin<e.yMin&&(e.yMin=t.yMin),t.xMax>e.xMax&&(e.xMax=t.xMax),t.yMax>e.yMax?e.yMax=t.yMax:void 0},t}(),e.exports=s},{"./macro-tool":7,"./standard-tool":12,"./svg-coord":13,"./unique-id":14}],12:[function(t,e,r){var i,o,n;n=t("./unique-id"),i=t("./pad-shapes"),o=function(t,e){var r,o,s,l,a,h,u;if(h={pad:[],trace:!1},e.cx=0,e.cy=0,o="tool-"+t+"-pad-"+n(),u="",null!=e.dia&&null==e.verticies){if(null!=e.obround||null!=e.width||null!=e.height||null!=e.degrees)throw new Error("incompatible parameters for tool "+t);
if(e.dia<0)throw new RangeError(t+" circle diameter out of range ("+e.dia+"<0)");u="circle",null==e.hole&&(h.trace={"stroke-width":e.dia,fill:"none"})}else if(null!=e.width&&null!=e.height){if(null!=e.dia||null!=e.verticies||null!=e.degrees)throw new Error("incompatible parameters for tool "+t);if(e.width<0)throw new RangeError(t+" rect width out of range ("+e.width+"<0)");if(e.height<0)throw new RangeError(t+" rect height out of range ("+e.height+"<0)");u="rect",0!==e.width&&0!==e.height||e.obround||(console.warn("zero-size rectangle tools are not allowed; converting "+t+" to a zero-size circle"),u="circle",e.dia=0),null!=e.hole||e.obround||(h.trace={})}else{if(null==e.dia||null==e.verticies)throw new Error("unidentified standard tool shape");if(null!=e.obround||null!=e.width||null!=e.height)throw new Error("incompatible parameters for tool "+t);if(e.verticies<3||e.verticies>12)throw new RangeError(t+" polygon points out of range ("+e.verticies+"<3 or >12)]");u="polygon"}if(a=i[u](e),null!=e.hole){if(r=null,null!=e.hole.dia&&null==e.hole.width&&null==e.hole.height){if(!(e.hole.dia>=0))throw new RangeError(t+" hole diameter out of range ("+e.hole.dia+"<0)");r=i.circle({cx:e.cx,cy:e.cy,dia:e.hole.dia}),r=r.shape,r.circle.fill="#000"}else{if(null==e.hole.width||null==e.hole.height)throw new Error(t+" has invalid hole parameters");if(!(e.hole.width>=0))throw new RangeError(t+" hole width out of range ("+e.hole.width+"<0)");if(!(e.hole.height>=0))throw new RangeError(t+" hole height out of range ("+e.hole.height+"<0)");r=i.rect({cx:e.cx,cy:e.cy,width:e.hole.width,height:e.hole.height}),r=r.shape,r.rect.fill="#000"}l=o+"-mask",s={mask:{id:o+"-mask",_:[{rect:{x:a.bbox[0],y:a.bbox[1],width:a.bbox[2]-a.bbox[0],height:a.bbox[3]-a.bbox[1],fill:"#fff"}},r]}},a.shape[u].mask="url(#"+l+")",h.pad.push(s)}return o&&(a.shape[u].id=o),h.pad.push(a.shape),h.bbox=a.bbox,h.padId=o,h},e.exports=o},{"./pad-shapes":9,"./unique-id":14}],13:[function(t,e,r){var i,o,n=[].indexOf||function(t){for(var e=0,r=this.length;r>e;e++)if(e in this&&this[e]===t)return e;return-1};i=3,o=function(t,e){var r,o,s,l,a,h,u,c,f,p,d,x,b,m;if(null==t)return NaN;if(t=""+t,o="",r="",b="+",("-"===t[0]||"+"===t[0])&&(b=t[0],t=t.slice(1)),n.call(t,".")>=0||null==e.zero){if(m=t.split("."),m.length>2)return NaN;p=[m[0],null!=(f=m[1])?f:""],o=p[0],r=p[1]}else{if("number"!=typeof(null!=e&&null!=(d=e.places)?d[0]:void 0)||"number"!=typeof(null!=e&&null!=(x=e.places)?x[1]:void 0))return NaN;if("T"===e.zero){for(l=a=0,u=t.length;u>a;l=++a)s=t[l],l<e.places[0]?o+=s:r+=s;for(;o.length<e.places[0];)o+="0"}else if("L"===e.zero){for(l=h=0,c=t.length;c>h;l=++h)s=t[l],t.length-l<=e.places[1]?r+=s:o+=s;for(;r.length<e.places[1];)r="0"+r}}for(;r.length<i;)r+="0";return o+=r.slice(0,i),r=r.length>i?"."+r.slice(i):"",Number(b+o+r)},e.exports={get:o,factor:Math.pow(10,i)}},{}],14:[function(t,e,r){var i,o;o=1e3,i=function(){return o++},e.exports=i},{}],15:[function(t,e,r){(function(r){var i,o,n,s,l,a,h,u;h=t("./obj-to-xml"),a=t("./plotter"),n=t("./drill-reader"),o=t("./drill-parser"),l=t("./gerber-reader"),s=t("./gerber-parser"),u=t("./svg-coord").factor,i={drill:!1,pretty:!1,object:!1,warnArr:null,places:null,zero:null,notation:null,units:null},e.exports=function(t,e){var c,f,p,d,x,b,m,g,w,y,v,M,k,E,q,_,R;null==e&&(e={}),b={};for(d in i)E=i[d],b[d]=E;for(d in e)E=e[d],b[d]=E;if("object"==typeof t){if(null!=t.svg)return h(t,{pretty:b.pretty});throw new Error("non SVG object cannot be converted to an SVG string")}w=null,(null!=b.places||null!=b.zero)&&(w={places:b.places,zero:b.zero}),b.drill?(v=new n(t),g=new o(w)):(v=new l(t),g=new s(w)),y=null,(null!=b.notation||null!=b.units)&&(y={notation:b.notation,units:b.units}),m=new a(v,g,y),x=null,k=null,Array.isArray(b.warnArr)&&(k="undefined"!=typeof window&&null!==window?window:r,null==k.console&&(k.console={}),x=k.console.warn,k.console.warn=function(t){return b.warnArr.push(t.toString())});try{R=m.plot()}catch(T){throw f=T,new Error("Error at line "+m.reader.line+" - "+f.message)}finally{null!=x&&null!=k&&(k.console.warn=x)}m.bbox.xMin>=m.bbox.xMax?(m.bbox.xMin=0,m.bbox.xMax=0,q=0):q=m.bbox.xMax-m.bbox.xMin,m.bbox.yMin>=m.bbox.yMax?(m.bbox.yMin=0,m.bbox.yMax=0,p=0):p=m.bbox.yMax-m.bbox.yMin,_={svg:{xmlns:"http://www.w3.org/2000/svg",version:"1.1","xmlns:xlink":"http://www.w3.org/1999/xlink",width:""+q/u+m.units,height:""+p/u+m.units,viewBox:[m.bbox.xMin,m.bbox.yMin,q,p],_:[]}},M=m.attr;for(c in M)E=M[c],_.svg[c]=E;return m.defs.length&&_.svg._.push({defs:{_:m.defs}}),m.group.g._.length&&_.svg._.push(m.group),b.object?_:h(_,{pretty:b.pretty})}}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./drill-parser":2,"./drill-reader":3,"./gerber-parser":4,"./gerber-reader":5,"./obj-to-xml":8,"./plotter":11,"./svg-coord":13}]},{},[15])(15)});
